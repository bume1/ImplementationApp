<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Thrive 365 Labs - Portal Directory</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <style>
    @media print {
      .no-print { display: none !important; }
      body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
    }
  </style>
</head>
<body class="bg-gray-50 min-h-screen p-8">
  <div id="content" class="max-w-4xl mx-auto bg-white rounded-2xl shadow-lg p-8">
    <!-- Header -->
    <div class="text-center mb-8 pb-6 border-b">
      <img src="/thrive365-logo.webp" alt="Thrive 365 Labs" class="h-16 mx-auto mb-4">
      <h1 class="text-3xl font-bold text-gray-800">Portal Directory</h1>
      <p class="text-gray-500 mt-2">Complete link reference for the Thrive 365 Labs Implementation Platform</p>
    </div>

    <!-- Client Portal Section -->
    <div class="mb-8">
      <h2 class="text-xl font-bold text-blue-800 mb-4 flex items-center gap-2">
        <span class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg>
        </span>
        Client Portal
      </h2>
      <p class="text-gray-600 text-sm mb-4">Access: Clients Only (authenticated)</p>

      <table class="w-full text-sm">
        <thead class="bg-gray-50">
          <tr>
            <th class="text-left p-3 font-semibold text-gray-700">Page</th>
            <th class="text-left p-3 font-semibold text-gray-700">URL Path</th>
            <th class="text-left p-3 font-semibold text-gray-700">Description</th>
          </tr>
        </thead>
        <tbody class="divide-y">
          <tr class="hover:bg-gray-50">
            <td class="p-3 font-medium">Home Dashboard</td>
            <td class="p-3 text-blue-600 font-mono text-xs">/portal/{client-slug}</td>
            <td class="p-3 text-gray-600">Overview, progress, announcements</td>
          </tr>
          <tr class="hover:bg-gray-50">
            <td class="p-3 font-medium">Launch Milestones</td>
            <td class="p-3 text-blue-600 font-mono text-xs">/portal/{client-slug}/milestones</td>
            <td class="p-3 text-gray-600">Project phases, tasks, timeline</td>
          </tr>
          <tr class="hover:bg-gray-50">
            <td class="p-3 font-medium">Inventory Manager</td>
            <td class="p-3 text-blue-600 font-mono text-xs">/portal/{client-slug}/inventory</td>
            <td class="p-3 text-gray-600">Submit inventory counts</td>
          </tr>
          <tr class="hover:bg-gray-50">
            <td class="p-3 font-medium">Inventory Reports</td>
            <td class="p-3 text-blue-600 font-mono text-xs">/portal/{client-slug}/reports</td>
            <td class="p-3 text-gray-600">View submitted inventory reports</td>
          </tr>
          <tr class="hover:bg-gray-50">
            <td class="p-3 font-medium">Submission History</td>
            <td class="p-3 text-blue-600 font-mono text-xs">/portal/{client-slug}/submission_history</td>
            <td class="p-3 text-gray-600">All past submissions</td>
          </tr>
          <tr class="hover:bg-gray-50">
            <td class="p-3 font-medium">Customer Support</td>
            <td class="p-3 text-blue-600 font-mono text-xs">/portal/{client-slug}/support</td>
            <td class="p-3 text-gray-600">Support center home</td>
          </tr>
          <tr class="hover:bg-gray-50">
            <td class="p-3 font-medium pl-6">- Ticket History</td>
            <td class="p-3 text-blue-600 font-mono text-xs">/portal/{client-slug}/support/tickets</td>
            <td class="p-3 text-gray-600">View support tickets</td>
          </tr>
          <tr class="hover:bg-gray-50">
            <td class="p-3 font-medium pl-6">- Submit Ticket</td>
            <td class="p-3 text-blue-600 font-mono text-xs">/portal/{client-slug}/support/submit</td>
            <td class="p-3 text-gray-600">Create new support ticket</td>
          </tr>
          <tr class="hover:bg-gray-50">
            <td class="p-3 font-medium pl-6">- Live Chat</td>
            <td class="p-3 text-blue-600 font-mono text-xs">/portal/{client-slug}/support/chat</td>
            <td class="p-3 text-gray-600">Chat with support team</td>
          </tr>
          <tr class="hover:bg-gray-50">
            <td class="p-3 font-medium">Files</td>
            <td class="p-3 text-blue-600 font-mono text-xs">/portal/{client-slug}/files</td>
            <td class="p-3 text-gray-600">Document uploads and downloads</td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Admin Hub Section -->
    <div class="mb-8">
      <h2 class="text-xl font-bold text-purple-800 mb-4 flex items-center gap-2">
        <span class="w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center text-purple-600">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/></svg>
        </span>
        Admin Hub
      </h2>
      <p class="text-gray-600 text-sm mb-4">Access: Administrators Only</p>

      <table class="w-full text-sm">
        <thead class="bg-gray-50">
          <tr>
            <th class="text-left p-3 font-semibold text-gray-700">Page</th>
            <th class="text-left p-3 font-semibold text-gray-700">URL Path</th>
            <th class="text-left p-3 font-semibold text-gray-700">Description</th>
          </tr>
        </thead>
        <tbody class="divide-y">
          <tr class="hover:bg-gray-50">
            <td class="p-3 font-medium">Admin Dashboard</td>
            <td class="p-3 text-purple-600 font-mono text-xs">/admin</td>
            <td class="p-3 text-gray-600">Main admin overview</td>
          </tr>
          <tr class="hover:bg-gray-50">
            <td class="p-3 font-medium">Portal Settings</td>
            <td class="p-3 text-purple-600 font-mono text-xs">/portal/{slug}/admin_settings</td>
            <td class="p-3 text-gray-600">Configure portal settings</td>
          </tr>
          <tr class="hover:bg-gray-50">
            <td class="p-3 font-medium">Announcements</td>
            <td class="p-3 text-purple-600 font-mono text-xs">/portal/{slug}/admin_announcements</td>
            <td class="p-3 text-gray-600">Manage announcements</td>
          </tr>
          <tr class="hover:bg-gray-50">
            <td class="p-3 font-medium">Documents</td>
            <td class="p-3 text-purple-600 font-mono text-xs">/portal/{slug}/admin_documents</td>
            <td class="p-3 text-gray-600">Manage shared documents</td>
          </tr>
          <tr class="hover:bg-gray-50">
            <td class="p-3 font-medium">Client Management</td>
            <td class="p-3 text-purple-600 font-mono text-xs">/portal/{slug}/admin_clients</td>
            <td class="p-3 text-gray-600">Manage client accounts</td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Public Pages Section -->
    <div class="mb-8">
      <h2 class="text-xl font-bold text-green-800 mb-4 flex items-center gap-2">
        <span class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center text-green-600">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
        </span>
        Public Resources
      </h2>
      <p class="text-gray-600 text-sm mb-4">Access: Public / No Authentication Required</p>

      <table class="w-full text-sm">
        <thead class="bg-gray-50">
          <tr>
            <th class="text-left p-3 font-semibold text-gray-700">Page</th>
            <th class="text-left p-3 font-semibold text-gray-700">URL Path</th>
            <th class="text-left p-3 font-semibold text-gray-700">Description</th>
          </tr>
        </thead>
        <tbody class="divide-y">
          <tr class="hover:bg-gray-50">
            <td class="p-3 font-medium">Knowledge Hub</td>
            <td class="p-3 text-green-600 font-mono text-xs">/knowledge</td>
            <td class="p-3 text-gray-600">Training materials and guides</td>
          </tr>
          <tr class="hover:bg-gray-50">
            <td class="p-3 font-medium">Changelog</td>
            <td class="p-3 text-green-600 font-mono text-xs">/changelog</td>
            <td class="p-3 text-gray-600">Platform version history</td>
          </tr>
          <tr class="hover:bg-gray-50">
            <td class="p-3 font-medium">Client Login</td>
            <td class="p-3 text-green-600 font-mono text-xs">/portal/{client-slug}/login</td>
            <td class="p-3 text-gray-600">Client portal login page</td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Current Client Portals -->
    <div class="mb-8">
      <h2 class="text-xl font-bold text-orange-800 mb-4 flex items-center gap-2">
        <span class="w-8 h-8 bg-orange-100 rounded-lg flex items-center justify-center text-orange-600">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/></svg>
        </span>
        Active Client Portals
      </h2>
      <p class="text-gray-600 text-sm mb-4">Direct links to client portals (authentication required)</p>
      <div id="client-list" class="grid grid-cols-2 gap-3">
        <p class="text-gray-500 italic col-span-2">Loading client list...</p>
      </div>
    </div>

    <!-- Footer -->
    <div class="mt-8 pt-6 border-t text-center text-sm text-gray-500">
      <p>Generated: <span id="gen-date"></span></p>
      <p class="mt-1">&copy; 2026 Thrive 365 Labs. All rights reserved.</p>
    </div>
  </div>

  <!-- Download Button -->
  <div class="no-print fixed bottom-8 right-8">
    <button onclick="downloadPDF()" class="bg-blue-600 text-white px-6 py-3 rounded-lg shadow-lg hover:bg-blue-700 flex items-center gap-2">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>
      Download PDF
    </button>
  </div>

  <script>
    // Set generation date
    document.getElementById('gen-date').textContent = new Date().toLocaleDateString('en-US', {
      year: 'numeric', month: 'long', day: 'numeric'
    });

    // Load client list
    fetch('/api/projects')
      .then(r => r.json())
      .then(projects => {
        const container = document.getElementById('client-list');
        if (projects && projects.length > 0) {
          container.innerHTML = projects.map(p => `
            <a href="/portal/${p.slug || p.clientName?.toLowerCase().replace(/\s+/g, '-')}"
               class="block p-3 bg-gray-50 rounded-lg hover:bg-orange-50 border border-gray-200">
              <span class="font-medium text-gray-800">${p.clientName || p.name}</span>
            </a>
          `).join('');
        } else {
          container.innerHTML = '<p class="text-gray-500 italic col-span-2">No active clients found</p>';
        }
      })
      .catch(() => {
        document.getElementById('client-list').innerHTML = '<p class="text-gray-500 italic col-span-2">Could not load client list</p>';
      });

    // Download PDF function
    function downloadPDF() {
      const element = document.getElementById('content');
      const opt = {
        margin: 0.5,
        filename: 'Thrive365-Portal-Directory.pdf',
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { scale: 2 },
        jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
      };
      html2pdf().set(opt).from(element).save();
    }
  </script>
</body>
</html>
