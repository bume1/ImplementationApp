<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Knowledge Hub - Thrive 365 Labs</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: { 50: '#E6F0F7', 100: '#CCE1EF', 500: '#045E9F', 600: '#034D82', 700: '#033C66', 800: '#022B49' },
            accent: '#1B2D4F',
            success: { 50: '#E6F7F1', 500: '#10B981', 600: '#059669' },
            warning: { 50: '#FEF9E7', 500: '#F59E0B', 600: '#D97706' }
          }
        }
      }
    };
  </script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    body { font-family: system-ui, -apple-system, sans-serif; background: linear-gradient(135deg, #f5f7fa 0%, #e4e8ec 100%); }
    .card-hover { transition: all 0.3s ease; }
    .card-hover:hover { transform: translateY(-4px); box-shadow: 0 12px 24px rgba(0,0,0,0.1); }
    .guide-content { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; }
    .guide-content.open { max-height: 2000px; transition: max-height 0.5s ease-in; }
    .search-input:focus { box-shadow: 0 0 0 3px rgba(4,94,159,0.15); outline: none; }
    .search-dropdown { max-height: 400px; overflow-y: auto; }
    .search-item { transition: background 0.15s ease; }
    .search-item:hover { background: #f0f7ff; }
    .section-tile { transition: all 0.2s ease; }
    .section-tile:hover { transform: translateY(-3px); box-shadow: 0 8px 24px rgba(0,0,0,0.12); }
    .breadcrumb-btn { transition: color 0.15s ease; }
    .breadcrumb-btn:hover { color: #045E9F; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect } = React;

    // Icons
    const Icons = {
      back: <svg className="w-5 h-5" fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"/></svg>,
      book: <svg className="w-8 h-8" fill="none" stroke="currentColor" strokeWidth="1.5" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"/></svg>,
      admin: <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="1.5" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"/><path strokeLinecap="round" strokeLinejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/></svg>,
      launch: <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="1.5" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M15.59 14.37a6 6 0 01-5.84 7.38v-4.8m5.84-2.58a14.98 14.98 0 006.16-12.12A14.98 14.98 0 009.631 8.41m5.96 5.96a14.926 14.926 0 01-5.841 2.58m-.119-8.54a6 6 0 00-7.381 5.84h4.8m2.581-5.84a14.927 14.927 0 00-2.58 5.84m2.699 2.7c-.103.021-.207.041-.311.06a15.09 15.09 0 01-2.448-2.448 14.9 14.9 0 01.06-.312m-2.24 2.39a4.493 4.493 0 00-1.757 4.306 4.493 4.493 0 004.306-1.758M16.5 9a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z"/></svg>,
      service: <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="1.5" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M11.42 15.17L17.25 21A2.652 2.652 0 0021 17.25l-5.877-5.877M11.42 15.17l2.496-3.03c.317-.384.74-.626 1.208-.766M11.42 15.17l-4.655 5.653a2.548 2.548 0 11-3.586-3.586l6.837-5.63m5.108-.233c.55-.164 1.163-.188 1.743-.14a4.5 4.5 0 004.486-6.336l-3.276 3.277a3.004 3.004 0 01-2.25-2.25l3.276-3.276a4.5 4.5 0 00-6.336 4.486c.091 1.076-.071 2.264-.904 2.95l-.102.085m-1.745 1.437L5.909 7.5H4.5L2.25 3.75l1.5-1.5L7.5 4.5v1.409l4.26 4.26m-1.745 1.437l1.745-1.437m6.615 8.206L15.75 15.75M4.867 19.125h.008v.008h-.008v-.008z"/></svg>,
      client: <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="1.5" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z"/></svg>,
      hub: <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="1.5" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"/></svg>,
      chevronDown: <svg className="w-5 h-5" fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M19 9l-7 7-7-7"/></svg>,
      chevronRight: <svg className="w-5 h-5" fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M9 5l7 7-7 7"/></svg>,
      link: <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="1.5" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"/></svg>,
      inventory: <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="1.5" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/></svg>,
      support: <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="1.5" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/></svg>,
      files: <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="1.5" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/></svg>,
      users: <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="1.5" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z"/></svg>,
      milestone: <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="1.5" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>,
      external: <svg className="w-4 h-4" fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/></svg>,
      code: <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="1.5" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M17.25 6.75L22.5 12l-5.25 5.25m-10.5 0L1.5 12l5.25-5.25m7.5-3l-4.5 16.5"/></svg>,
      lock: <svg className="w-4 h-4" fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M16.5 10.5V6.75a4.5 4.5 0 10-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 002.25-2.25v-6.75a2.25 2.25 0 00-2.25-2.25H6.75a2.25 2.25 0 00-2.25 2.25v6.75a2.25 2.25 0 002.25 2.25z"/></svg>
    };

    // Comprehensive Guide Data - Expert Level How-Tos for Internal Users
    const guides = {
      'portal-hub': {
        title: 'Portal Hub',
        description: 'Your central navigation point for all Thrive 365 Labs services',
        icon: Icons.hub,
        color: 'bg-primary-500',
        articles: [
          {
            title: 'Getting Started with Portal Hub',
            content: `Welcome to the Thrive 365 Labs Portal Hub. This is your command center after logging in. Here's everything you need to know to navigate the system effectively.

**STEP 1: Logging In**
1. Open your web browser (Chrome or Firefox recommended)
2. Navigate to the login page URL provided by your administrator
3. Enter your email address exactly as it was registered (this is case-sensitive)
4. Enter your password
5. Click "Sign In"

**IMPORTANT:** If this is your first login after a password reset, you'll be prompted to create a new password. Choose something with at least 8 characters mixing letters and numbers.

**STEP 2: Understanding the Dashboard**
After login, you'll see colored tiles representing different portals. Each tile you see means you have access to that area:

• **Admin Hub** (Blue tile) - System administration and user management
• **Implementations** (Purple tile) - Client project tracking and launch management
• **Service Portal** (Green tile) - Submit service reports and validation documentation
• **Client Portal Admin** (Orange tile) - Manage client-facing content and documents
• **Knowledge Hub** (Teal tile) - You're here! Documentation and guides

**STEP 3: Navigating Between Portals**
- Click any tile to enter that portal
- Use the "Portal Hub" link in the sidebar (or bottom of page) to return here
- You can have multiple browser tabs open for different portals

**PRO TIP:** Bookmark the Portal Hub URL for quick access each morning.

**TROUBLESHOOTING:**
- If a tile is missing, you don't have permission for that portal - contact your administrator
- If the page won't load, try clearing your browser cache (Ctrl+Shift+Delete)
- If you're logged out unexpectedly, your session expired after 24 hours - just log in again`
          },
          {
            title: 'Understanding Your Permissions',
            content: `Your access within the system is controlled by permission flags. Understanding these helps you know what you can and cannot do.

**PERMISSION TYPES EXPLAINED:**

1. **Admin Hub Access**
   - View system dashboard with statistics
   - Manage user accounts (create, edit, delete)
   - Process password reset requests
   - View bug reports and feature requests
   - WHO NEEDS THIS: System administrators, IT staff, operations managers

2. **Implementations Access**
   - View and manage client launch projects
   - Track task completion across implementation phases
   - Access project boards and timelines
   - Generate reports and checklists
   - WHO NEEDS THIS: Project managers, implementation specialists, account managers

3. **Service Portal Access**
   - Submit service reports for client visits
   - Submit validation reports for equipment
   - View your submitted reports
   - Access assigned service tasks
   - WHO NEEDS THIS: Field Service Engineers (FSE), Clinical Application Specialists (CAS), service technicians

4. **Client Portal Admin Access**
   - Manage client portal announcements
   - Upload documents for specific clients
   - View client inventory submissions
   - Manage client portal settings
   - WHO NEEDS THIS: Account managers, client success team, operations

**THE MANAGER FLAG:**
If you have the "Is Manager" designation, you get limited Admin Hub access without full admin privileges. This allows you to:
- View dashboard statistics
- Manage Service Portal assignments
- See team activity

**HOW TO REQUEST ADDITIONAL ACCESS:**
1. Identify which portal(s) you need access to
2. Document why you need this access (what tasks require it)
3. Contact your system administrator or supervisor
4. They will update your permissions in Admin Hub > User Management

**SECURITY NOTE:** We follow the principle of "least privilege" - you should only have access to what you need for your job. This protects client data and system integrity.`
          },
          {
            title: 'Daily Workflow Best Practices',
            content: `Here's a recommended daily workflow for getting the most out of the system.

**MORNING ROUTINE (5-10 minutes):**

1. **Log into Portal Hub**
   - Check which portals show notifications or alerts
   - Red badges indicate items needing attention

2. **Check Admin Hub (if you have access)**
   - Review the Inbox for new bug reports or password reset requests
   - Note any urgent items that need immediate attention
   - Check dashboard stats for any anomalies

3. **Check Implementations (if managing projects)**
   - Review your assigned projects
   - Check for any overdue tasks
   - Note upcoming milestones for the week

4. **Check Service Portal (if you're FSE/CAS)**
   - Review any assigned service visits
   - Check for incomplete report drafts
   - Note any pending tasks from managers

**THROUGHOUT THE DAY:**
- Submit service reports within 24 hours of completing service calls
- Update project task status as you complete work
- Respond to assigned items promptly

**END OF DAY:**
- Ensure all service reports from the day are submitted (not left as drafts)
- Update any project tasks completed
- Log out if using a shared computer

**WEEKLY:**
- Review all your submitted reports for completeness
- Check for any stale tasks or projects
- Ensure client documents are up to date

**PRO TIPS:**
- Keep the Portal Hub open in a browser tab all day
- Use browser bookmarks for frequently accessed pages
- Take screenshots of any errors to help with troubleshooting
- When in doubt, save as draft before navigating away`
          }
        ]
      },
      'admin-hub': {
        title: 'Admin Hub',
        description: 'User management, permissions, and administration',
        icon: Icons.admin,
        color: 'bg-blue-600',
        articles: [
          {
            title: 'Admin Dashboard Overview',
            content: `The Admin Hub is the control center for system administration. Here's a complete walkthrough of every feature.

**ACCESSING ADMIN HUB:**
1. From Portal Hub, click the "Admin Hub" tile
2. Or navigate directly to /admin-hub in your browser
3. You must have Admin Hub Access permission to enter

**DASHBOARD COMPONENTS:**

**1. Quick Stats Cards (Top Section)**
These give you an at-a-glance view of system status:

• **New Launches** - Shows count of active implementation projects
  - Click to jump directly to the Launch App
  - Projects in "Complete" status are not counted

• **Open Tickets** - Total pending items in your inbox
  - Includes bug reports, feature requests, and password resets
  - Click to jump to the Inbox

**2. Navigation Sidebar (Left Side)**
The sidebar contains links to all Admin Hub sections:
• Dashboard (home)
• Inbox (pending requests)
• User Management (all user accounts)
• Service Portal (service report management)
• Plus navigation back to Portal Hub

**3. Inbox Preview (Main Area)**
Shows the most recent inbox items without needing to navigate to the full inbox.

**DAILY ADMIN CHECKLIST:**
□ Check inbox for password reset requests (urgent - users are blocked)
□ Review any new bug reports
□ Check dashboard stats for unusual numbers
□ Process any pending feature requests

**WARNING:** Password reset requests should be handled same-day. Users cannot access the system until their password is reset.`
          },
          {
            title: 'Creating New User Accounts',
            content: `Complete step-by-step guide for creating new user accounts in the system.

**BEFORE YOU START:**
Gather this information about the new user:
- Full name
- Email address (this will be their username)
- What role they need (see role descriptions below)
- Which portals they need access to
- For clients: which practice/organization they belong to
- For vendors: which clients they should access

**STEP-BY-STEP PROCESS:**

**Step 1: Navigate to User Management**
1. Click "User Management" in the Admin Hub sidebar
2. You'll see a list of all existing users

**Step 2: Open the Add User Form**
1. Click the "+ Add User" button (top right)
2. A form will appear with all the fields

**Step 3: Fill in Basic Information**
• **Name**: Full name as it should appear in the system
• **Email**: Their email address (becomes their login username)
  - IMPORTANT: Double-check spelling - cannot be easily changed later
• **Password**: Create a temporary password for them
  - Minimum 8 characters
  - They will change this on first login

**Step 4: Select the Appropriate Role**

• **Admin** - ONLY for IT/system administrators
  - Full access to everything
  - Can manage all users and settings
  - Use sparingly

• **Team Member** - Most internal Thrive 365 employees
  - Access controlled by permission toggles (see Step 5)
  - Can have Manager designation for additional capabilities

• **Client** - External client users
  - Access only to their specific client portal
  - Must be assigned to a practice (see Step 6)

• **Vendor** - External service providers
  - Limited access to assigned client accounts only
  - Must have Service Portal Access enabled
  - Must have assigned clients specified (see Step 6)

**Step 5: Configure Permissions (Team Members)**
Toggle ON the permissions they need:

□ **Has Admin Hub Access** - View dashboard, manage users, handle inbox
□ **Has Implementations Access** - Use the Launch App for project tracking
□ **Has Service Portal Access** - Submit service and validation reports
□ **Has Client Portal Admin** - Manage client announcements and documents
□ **Is Manager** - Limited admin access without full admin privileges

**Step 6: Assign Practice/Clients (Client and Vendor roles)**
• For Clients: Select their practice from the dropdown
• For Vendors: Select which client accounts they can access

**Step 7: Save the User**
1. Review all fields for accuracy
2. Click "Save" or "Create User"
3. The user will appear in the user list

**Step 8: Communicate Login Details**
Send the new user:
- Their email address (username)
- The temporary password you created
- The login URL
- Instruct them to change their password on first login

**COMMON MISTAKES TO AVOID:**
❌ Typos in email addresses - user won't be able to log in
❌ Giving too many permissions - follow least-privilege principle
❌ Forgetting to assign practice for client users
❌ Not communicating the temporary password securely`
          },
          {
            title: 'Editing and Managing Existing Users',
            content: `How to modify existing user accounts, reset passwords, and manage access.

**FINDING A USER:**
1. Go to User Management
2. Use the search box to find users by name or email
3. Scroll through the list if needed
4. Click on a user to view/edit their details

**EDITING USER INFORMATION:**

**Step 1: Open the User**
Click on the user's row in the list to open their details

**Step 2: Make Changes**
You can modify:
• Name
• Email (be careful - this changes their login)
• Role
• All permission toggles
• Practice/client assignments
• Manager designation

**Step 3: Save Changes**
Click "Save" to apply your changes immediately

**RESETTING A SINGLE USER'S PASSWORD:**
1. Find and open the user
2. Enter a new temporary password in the password field
3. Save the user
4. Communicate the new password to the user
5. User will be prompted to change it on next login

**BULK PASSWORD RESET:**
Use this when you need to reset passwords for multiple users at once:
1. In the user list, check the boxes next to users who need reset
2. Click the "Reset Passwords" button at the top
3. Confirm the action
4. System generates temporary passwords for all selected users
5. Users receive notification and must change password on next login

**DEACTIVATING A USER:**
When an employee leaves or a client relationship ends:
1. Find the user in the list
2. You can either:
   - Delete the user entirely (removes all history)
   - Remove all permissions (preserves audit trail)
3. For compliance, we recommend removing permissions rather than deleting

**TRANSFERRING RESPONSIBILITIES:**
When someone leaves and another takes over:
1. Create the new user account first
2. Transfer any project assignments in Launch App
3. Update any client portal admin responsibilities
4. Then deactivate the old user

**AUDIT CHECKLIST (Quarterly):**
□ Review all Admin role users - still appropriate?
□ Check for inactive users (no recent login)
□ Verify vendor access is still needed
□ Confirm client users match active client relationships
□ Remove access for any departed employees`
          },
          {
            title: 'Processing Inbox Items',
            content: `The Inbox is where all system requests collect. Here's how to handle each type efficiently.

**ACCESSING THE INBOX:**
1. Click "Inbox" in the Admin Hub sidebar
2. Or click the "Open Tickets" stat on the dashboard
3. Items are sorted by date (newest first)

**INBOX ITEM TYPES:**

**1. PASSWORD RESET REQUESTS** (Highest Priority)
These are from users who forgot their password and cannot log in.

How to Process:
1. Click on the password reset request to view details
2. Note the user's email address
3. Go to User Management
4. Find and open that user's account
5. Enter a new temporary password
6. Save the user
7. Return to Inbox and mark the request as "Resolved"
8. Contact the user with their new temporary password

⚠️ URGENT: Process these same-day. Users are completely blocked until resolved.

**2. BUG REPORTS** (High Priority)
Issues reported by users through the feedback form.

How to Process:
1. Click to view the full bug report details
2. Try to reproduce the issue yourself
3. Document the steps to reproduce and any error messages
4. Either:
   - Fix the issue if you can
   - Escalate to technical team with details
5. Mark as "Resolved" once fixed
6. Optionally notify the reporter that it's fixed

Look For Patterns:
- Multiple reports about the same issue = system-wide problem
- Specific user having many issues = possible training need or account problem

**3. FEATURE REQUESTS** (Lower Priority)
Suggestions from users for new functionality.

How to Process:
1. Review the request
2. Determine if it's feasible/valuable
3. Either:
   - Add to development backlog
   - Mark as "Won't Do" with explanation
   - Mark as "Duplicate" if already requested
4. You can leave these open for tracking

**INBOX BEST PRACTICES:**

✓ Check inbox first thing every morning
✓ Process password resets immediately
✓ Respond to bug reports within 24 hours
✓ Keep notes on recurring issues
✓ Clear resolved items regularly to keep inbox manageable

**KEYBOARD SHORTCUTS:**
- R = Mark as Resolved
- D = Delete item
- N = View next item`
          },
          {
            title: 'Service Portal Management',
            content: `Administrators and managers can oversee service reports and assignments from Admin Hub.

**ACCESSING SERVICE PORTAL ADMIN:**
1. Click "Service Portal" in the Admin Hub sidebar
2. You'll see tabs for different functions

**AVAILABLE TABS:**

**1. Service Reports Tab**
View all submitted service reports across the organization.

Features:
• Search by client name, service type, or technician
• Filter by date range
• View report details by clicking "View"
• See report status (Assigned vs Submitted)

Report Statuses Explained:
• **Assigned** - Task given to technician, not yet completed
• **Submitted** - Technician has completed and submitted the report

**2. Validation Reports Tab**
View all validation reports submitted.

Features:
• See validation dates and duration
• View analyzers validated
• Download validation documentation
• Filter by client

**3. Vendors Tab (Admin only)**
Manage vendor accounts and their client assignments.

Features:
• View all vendor users
• See which clients each vendor is assigned to
• Add/remove vendor client assignments

**ASSIGNING SERVICE VISITS:**
As an admin or manager, you can assign service visits to technicians:
1. This feature is available in the Service Portal directly
2. Select a technician/vendor from the dropdown
3. Fill in client information, service type, dates
4. Add manager notes to give context
5. Attach photos or reference files
6. Submit the assignment

The technician will then:
- See the assignment in their Service Portal dashboard
- See a red notification banner
- Be able to click "Complete Report" to fill in their findings
- Submit the completed report

**MONITORING ASSIGNED WORK:**
- Check the Service Reports tab for "Assigned" status items
- These are pending completion by technicians
- Follow up if assignments aren't completed timely`
          }
        ]
      },
      'launch-app': {
        title: 'Launch App (Implementations)',
        description: 'Project tracking, client onboarding, and implementations',
        icon: Icons.launch,
        color: 'bg-purple-600',
        articles: [
          {
            title: 'Understanding the Project Board',
            content: `The Launch App is your central tool for tracking client implementation projects from start to finish.

**ACCESSING THE LAUNCH APP:**
1. From Portal Hub, click the "Implementations" tile
2. Or navigate directly to /launch/home
3. Requires "Has Implementations Access" permission

**THE PROJECT BOARD:**

When you first enter, you'll see the Kanban-style project board with columns for each status:

**Column 1: New/Pending**
- Projects that have been created but not started
- May be waiting for contracts, scheduling, or resources

**Column 2: In Progress**
- Active projects currently being worked on
- This is where most of your attention should be

**Column 3: On Hold**
- Projects paused for various reasons
- Hover over the project to see notes about why it's on hold

**Column 4: Complete**
- Finished projects
- Kept for reference and reporting

**PROJECT CARDS:**
Each project appears as a card showing:
• Client name (large, bold text)
• Current phase (e.g., "Installation", "Validation")
• Progress bar showing % complete
• Team member avatars (who's assigned)
• Due date indicator

**SWITCHING VIEWS:**
- Click "Board View" for Kanban columns
- Click "List View" for a traditional table format
- Use the search box to find specific projects

**FILTERING AND SORTING:**
- Search by client name
- Filter by status
- Filter by assigned team member
- Sort by due date or progress`
          },
          {
            title: 'Creating a New Project',
            content: `Step-by-step instructions for creating a new implementation project.

**BEFORE YOU START:**
Gather this information:
- Client/practice name
- HubSpot Deal ID (if syncing with HubSpot)
- Target start and completion dates
- Which team members will be assigned
- Which template to use (typically Biolis AU480 CLIA)

**STEP-BY-STEP PROCESS:**

**Step 1: Click "New Project"**
1. Click the "+ New Project" button (top right of the board)
2. A form will open

**Step 2: Enter Basic Information**
• **Project Name**: Usually the client/practice name
• **Client/Practice Name**: The organization name
• **Description**: Brief description of the implementation scope

**Step 3: Select a Template**
Choose from available templates:
• **Biolis AU480 CLIA** - Standard 102-task template for CLIA lab implementations
• Other templates as available

The template determines which tasks are automatically created for the project.

**Step 4: Link to HubSpot (Optional but Recommended)**
• **HubSpot Deal ID**: Enter the Deal ID from HubSpot
• This enables automatic syncing of progress
• Files can be uploaded directly to the deal record

**Step 5: Set Target Dates**
• **Start Date**: When work begins
• **Target Completion Date**: Expected finish date

**Step 6: Assign Team Members**
• Click to add team members
• Each member can be notified of task assignments
• You can assign multiple people

**Step 7: Save the Project**
1. Review all information
2. Click "Create Project"
3. The project will appear in the "New/Pending" column

**WHAT HAPPENS AFTER CREATION:**
- All template tasks are generated
- Project appears on the board
- Team members can start working on tasks
- Progress tracking begins

**PRO TIP:** Always link to HubSpot when possible - this ensures all documentation flows to the CRM automatically.`
          },
          {
            title: 'Working with Project Tasks',
            content: `How to manage tasks within a project - viewing, completing, adding notes, and uploading files.

**OPENING A PROJECT:**
Click on any project card to open the detailed view.

**UNDERSTANDING THE TASK VIEW:**

Tasks are organized by **Stages** (phases of the implementation):
1. Planning & Preparation
2. Site Assessment
3. Equipment Installation
4. Validation & Testing
5. Training
6. Go-Live
7. Post-Launch Support

Each stage contains multiple tasks that must be completed.

**TASK INFORMATION:**
Each task shows:
• Task name and description
• Assigned owner
• Due date
• Completion status (checkbox)
• Subtasks (if any)
• Attachments

**COMPLETING A TASK:**

**Step 1: Find the task**
Scroll through stages or use search to find your task

**Step 2: Review requirements**
Click on the task to expand details. Make sure you understand what's needed.

**Step 3: Do the work**
Complete whatever the task requires in the real world

**Step 4: Add documentation**
Before marking complete, add any relevant:
• Notes about what was done
• Files (reports, photos, documents)
• Updated information

**Step 5: Check the box**
Click the checkbox to mark the task complete

⚠️ **WARNING:** Some tasks have subtasks that must ALL be completed before the main task can be marked done.

**ADDING NOTES TO A TASK:**
1. Click on the task to expand it
2. Find the "Notes" section
3. Click "Add Note"
4. Type your note (be specific and include dates/details)
5. Save

**UPLOADING FILES TO A TASK:**
1. Expand the task
2. Find the "Attachments" section
3. Click "Upload" or drag and drop files
4. Supported formats: PDF, Word, Excel, images
5. Files are automatically stored and accessible to all team members

**REASSIGNING A TASK:**
If a task needs to be handled by someone else:
1. Expand the task
2. Click on the current owner
3. Select a new owner from the dropdown
4. Save

**PRO TIPS:**
- Complete tasks as you go, don't batch them up
- Add notes explaining any deviations from standard process
- Upload photos as documentation for installation tasks
- Check task dependencies - some tasks can't start until others are done`
          },
          {
            title: 'Project Progress and Reporting',
            content: `Understanding project progress metrics and generating reports.

**PROGRESS TRACKING:**

**Project Progress Bar:**
Shows overall completion percentage calculated as:
(Completed Tasks / Total Tasks) × 100

**Stage Progress:**
Each stage has its own progress indicator showing completion within that phase.

**UNDERSTANDING THE METRICS:**

• **Green** = On track or ahead
• **Yellow** = Slightly behind but recoverable
• **Red** = Significantly behind, needs attention

**GENERATING THE SOFT-PILOT CHECKLIST:**

The Soft-Pilot Checklist is a comprehensive document summarizing project readiness for go-live.

**To Generate:**
1. Open the project
2. Click "Generate Soft-Pilot Checklist"
3. The system compiles all task completions and notes
4. A PDF is generated
5. If HubSpot is linked, it's automatically uploaded to the deal

**WHAT'S INCLUDED:**
- All completed tasks with timestamps
- Task notes and documentation
- Completion status by stage
- Overall readiness assessment

**HUBSPOT SYNC:**

If your project is linked to a HubSpot deal:
- Progress updates can sync to deal stage
- Documents upload to deal files
- Notes sync to deal activity
- Stage mapping is configurable

**To Manually Sync:**
1. Open the project
2. Click "Sync to HubSpot"
3. Current progress pushes to the deal record

**VIEWING PROJECT HISTORY:**
- All changes are logged
- Click "Activity Log" to see what changed and when
- Useful for auditing and troubleshooting

**EXPORTING PROJECT DATA:**
1. Open the project
2. Click "Export"
3. Choose format (CSV or PDF)
4. Download for external reporting or records`
          },
          {
            title: 'What Clients See: Launch Milestones',
            content: `Understanding how clients view their implementation progress in their portal.

**CLIENT VISIBILITY:**

Clients with active implementation projects see a "Launch Milestones" section in their portal showing:

• Current phase name (e.g., "Validation & Testing")
• Visual progress bar
• List of completed milestones
• Upcoming milestones
• Overall percentage complete

**WHAT CLIENTS CAN DO:**
- View progress (read-only)
- See which tasks are complete
- Understand what's coming next
- Cannot edit tasks or mark complete

**WHAT CLIENTS CANNOT SEE:**
- Internal notes
- Team member details
- Detailed task descriptions
- File attachments (unless specifically shared)

**CONTROLLING CLIENT VISIBILITY:**

By default, major milestones (stage completions) are visible. Internal tasks within stages may not be.

To manage what clients see:
- Use stage-level tasks for client visibility
- Keep granular tasks internal
- Share progress updates verbally for sensitive items

**WHEN CLIENTS ASK QUESTIONS:**

If a client asks about progress:
1. Open their project in Launch App
2. Review current status
3. Note any blockers or dependencies
4. Provide accurate update based on actual completion

**PRO TIP:** Review project progress before client calls so you can speak confidently about status.

**COMPLETION:**
When a project is marked "Complete":
- Launch Milestones section no longer appears in client portal
- Project moves to Complete column in your board
- Historical data remains for reference`
          }
        ]
      },
      'service-portal': {
        title: 'Service Portal',
        description: 'Service reports, field operations, and vendor management',
        icon: Icons.service,
        color: 'bg-emerald-600',
        articles: [
          {
            title: 'Service Portal Overview',
            content: `The Service Portal is the dedicated workspace for Field Service Engineers (FSE), Clinical Application Specialists (CAS), and service technicians to document all service activities.

**ACCESSING THE SERVICE PORTAL:**
1. From Portal Hub, click the "Service Portal" tile
2. Or navigate directly to /service-portal
3. Requires "Has Service Portal Access" permission

**YOUR DASHBOARD:**

When you log in, you'll see your personalized dashboard with:

**1. Welcome Banner**
Shows your name and role (Vendor, Technician, or Super Admin)

**2. Assigned Service Visits (Red Alert Box)**
If managers have assigned work to you, you'll see a red notification box showing:
- Number of pending assignments
- Client names
- Due dates
- "Complete Report" buttons

⚠️ **IMPORTANT:** Red notification = work assigned to YOU that needs attention

**3. Quick Action Cards**
- **New Service Report** - Create a new report from scratch
- **Service Reports** - View all your submitted reports
- **My Reports Count** - Total reports you've submitted

**4. Recent Service Reports**
Shows your 5 most recent submissions for quick reference

**THE SIDEBAR MENU:**
- Dashboard - Return to home
- New Service Report - Start a new report
- Service Reports - View all reports

**TWO WAYS TO CREATE REPORTS:**

1. **Self-Initiated Reports**
   When you complete a service call, you create the report yourself with all details

2. **Assigned Reports**
   A manager assigns a service visit to you with pre-filled client info. You complete it after the visit.`
          },
          {
            title: 'Creating a New Service Report (Self-Initiated)',
            content: `Complete step-by-step guide for creating a service report when you initiate the work yourself.

**WHEN TO USE:**
- You completed a service call not pre-assigned to you
- You're documenting service work you initiated
- Ad-hoc service visits

**STEP-BY-STEP PROCESS:**

**Step 1: Start a New Report**
1. Click "New Service Report" in the sidebar
2. Or click the "New Service Report" card on dashboard

**Step 2: Select the Client**
• Click the "Client/Facility" dropdown
• Search or scroll to find your client
• Select the client

The system may auto-fill some fields based on the client record.

**Step 3: Fill in Client Information**
• **Customer Name**: Contact person you worked with
• **Address**: Service location (may auto-fill)
• **Service Completion Date**: Date you performed the service

**Step 4: Select Service Type** (Required)
Choose from:
- Analyzer Hardware
- Inventory
- LIS/EMR
- Billing & Fees
- Compliance
- Training
- Validations (triggers additional fields)

**Step 5: Enter Equipment Details**
• **Analyzer Model**: Equipment model serviced
• **Analyzer Serial Number**: S/N of the unit
• **HubSpot Ticket #**: If this relates to a support ticket

**Step 6: Document Your Work** (Required)
• **Description of Work Performed**: Detailed description of what you did
  - Be specific: "Replaced reagent tubing, calibrated analyzer, verified results"
  - Include any issues found and how they were resolved

• **Materials Used**: List any parts or supplies used
  - Include part numbers if available
  - Note quantities

• **Solution Provided**: What was the outcome/fix?

• **Outstanding Issues/Recommendations**: Note anything that still needs attention

**Step 7: For Validation Service Type**
If you selected "Validations", additional fields appear:
• Start Date / End Date
• Days On-Site (auto-calculated)
• Analyzers Validated (model, serial, pass/fail)
• Training Provided
• Test Procedures (detailed testing protocol)
• Validation Results
• Optional: Upload validation report file

**Step 8: Capture Signatures** (Required)

**Technician Signature:**
1. Click in the signature box
2. Use your mouse/finger to sign
3. Click "Save" to lock it in
4. Click "Clear" if you need to redo

**Customer Signature:**
1. Hand device to customer
2. Have them sign in the box
3. Click "Save"
4. IMPORTANT: Get this before leaving the site!

**Step 9: Review and Submit**
1. Scroll through and verify all information
2. Click "Submit Report"
3. Wait for confirmation message

**AFTER SUBMISSION:**
- Report is saved permanently
- PDF is generated automatically
- If client has HubSpot record, a ticket is created
- PDF is attached to HubSpot company record
- Client can view in their support ticket history

**SAVING DRAFTS:**
Click "Save as Draft" if you need to:
- Step away and return later
- Gather more information
- Wait for customer signature

Drafts are saved to your browser and restored when you return.

**PRO TIPS:**
✓ Complete reports same-day while details are fresh
✓ Take photos during service for reference
✓ Be specific in descriptions - they become permanent records
✓ Always get customer signature before leaving`
          },
          {
            title: 'Completing Assigned Service Visits',
            content: `How to complete service reports that were assigned to you by a manager.

**UNDERSTANDING ASSIGNED WORK:**

When a manager assigns a service visit to you:
1. They pre-fill client information, service type, and notes
2. You receive the assignment in your dashboard
3. You perform the service visit
4. You complete the report with your findings and signatures

**FINDING YOUR ASSIGNMENTS:**

**On Dashboard:**
- Red alert box at top shows pending assignments
- Each shows client name, service type, due date

**What's Pre-Filled for You:**
- Client/Facility name
- Customer contact
- Address
- Service type
- Equipment details
- Manager notes (context for the visit)
- Reference photos (if provided)
- Client files (documents you might need)

**STEP-BY-STEP COMPLETION:**

**Step 1: Review the Assignment**
1. Click "Complete Report" on the assignment
2. Read the Assignment Details section carefully
3. Note any manager instructions
4. Review attached photos and files

**Step 2: Perform the Service Visit**
Do your work based on the assignment details.

**Step 3: Return to Complete the Report**
After the visit, you fill in:

• **Service Date**: Actual date of service (may differ from scheduled)

• **Description of Work Performed**: What you actually did
  - Be thorough - this is your documentation

• **Materials Used**: Parts/supplies consumed

• **Solution Provided**: How you resolved the issue

• **Outstanding Issues**: Anything still needing attention

**Step 4: Validation Fields (if applicable)**
If it's a validation-type service:
• Validation Start/End dates
• Training provided
• Test procedures used
• Validation results

**Step 5: Signatures**
Same as self-initiated reports:
1. Your technician signature
2. Customer signature

**Step 6: Submit**
Click "Submit Service Report" to complete.

**WHAT HAPPENS AFTER:**
- Assignment is marked complete
- Report appears in Service Reports list
- Manager can see the completed report
- PDF generated and synced to HubSpot

**IMPORTANT NOTES:**

⚠️ You cannot change the pre-filled client information - that's set by the manager

⚠️ If something is wrong with the assignment, contact your manager before starting

⚠️ Complete assignments promptly - they show as pending until done`
          },
          {
            title: 'Validation Reports: Complete Guide',
            content: `Detailed guide for creating comprehensive validation reports.

**WHEN TO CREATE A VALIDATION REPORT:**
- Initial equipment validation after installation
- Annual revalidation requirements
- Post-repair validation
- Method validation for new tests
- CLIA compliance documentation

**SELECTING VALIDATIONS SERVICE TYPE:**

When you choose "Validations" as your service type, additional fields appear that are specific to validation work.

**VALIDATION-SPECIFIC FIELDS:**

**1. Start Date / End Date**
- Enter the actual dates of validation activities
- System calculates "Days On-Site" automatically

**2. Analyzers Validated**
Click "+ Add Analyzer" for each unit validated:
• Model number
• Serial number
• Status: Passed, Failed, or Conditional

You can add multiple analyzers if validating several units.

**3. Training Provided**
Document any training given to client staff:
- What topics were covered
- Who was trained
- Duration and format

**4. Test Procedures** (Required)
This is a critical field. Document exactly what procedures you performed:
- Precision testing (how many levels, how many runs)
- Accuracy testing (comparison method)
- Linearity (range tested)
- Reportable range verification
- Reference interval verification
- Carry-over testing
- Any other tests performed

Example:
"Precision: 3 levels × 5 runs over 3 days. Accuracy: 40 patient samples compared to reference lab method. Linearity: Tested across manufacturer-stated range. Reference intervals verified against published values."

**5. Validation Results** (Required)
Document the outcomes:
- Which tests passed/failed
- Any values outside expected ranges
- Correlation coefficients
- Summary of performance

**6. Validation Report File**
Upload your detailed validation document:
- Click "Upload" or drag and drop
- Accepted formats: PDF, Word, Excel
- This is attached to the final report

**SIGNATURES:**
Both signatures are especially important for validation reports as they serve as official approval of the validation.

**BEST PRACTICES:**
✓ Document everything in detail - validations are regulatory records
✓ Include specific numbers and results, not just "passed"
✓ Attach the full validation report file
✓ Ensure customer understands what they're signing
✓ Keep copies of raw data if needed

**COMMON MISTAKES TO AVOID:**
❌ Vague descriptions ("did validation testing")
❌ Missing test procedure details
❌ Forgetting to upload the validation report file
❌ Not getting customer signature
❌ Wrong dates (must be actual dates, not submission date)`
          },
          {
            title: 'Viewing Your Service Report History',
            content: `How to find, view, and manage your submitted service reports.

**ACCESSING REPORT HISTORY:**
1. Click "Service Reports" in the sidebar
2. Or click the "Service Reports" card on dashboard

**THE REPORTS LIST:**

You'll see a table with all your submitted reports showing:
• Status (Submitted, Assigned)
• Date
• Client name
• Service type
• Actions (View)

**SEARCHING AND FILTERING:**

**Search Box:**
Type to search by:
- Client name
- Service type
- Technician name

**VIEWING A REPORT:**
1. Find the report in the list
2. Click the "View" button
3. Full report details display

**REPORT DETAIL VIEW:**

The view shows all information from your submission:
- Client information
- Service details
- Description of work
- Materials and solutions
- Signatures (displayed as images)
- For validations: all validation-specific data

**WHAT YOU CANNOT DO:**
- Edit submitted reports (they're permanent records)
- Delete reports
- Change signatures

If you made an error:
- Contact your administrator
- They may be able to add a correction note
- A new report may be needed for significant errors

**PDF GENERATION:**
Each submitted report generates a PDF that:
- Is stored in the system
- Syncs to HubSpot (if client has record)
- Can be downloaded for reference
- Is attached to the client's support ticket history

**PRO TIP:** Regularly review your recent reports to ensure accuracy while details are still fresh in memory.`
          },
          {
            title: 'Managing Vendors and Service Assignments (Managers)',
            content: `This guide is for Managers who need to manage vendors, assign service visits, and oversee service operations.

**ACCESSING SERVICE PORTAL ADMIN FEATURES:**

Managers with "Service Portal" access enabled can access full admin features:
1. Go to Admin Hub → Service Portal section
2. You'll see three tabs: Service Reports, Validation Reports, and Vendors

**REQUIRED PERMISSION:**
• You must be a Manager (isManager = true)
• AND have "Service Portal" checkbox enabled in your user settings
• Super Admins automatically have full access

---

**MANAGING EXTERNAL VENDORS:**

The Vendors tab allows you to add and manage external service technicians.

**Adding a New Vendor:**
1. Click "Add Vendor" button
2. Fill in required fields:
   • **Name**: Vendor's full name
   • **Email**: Their login email
   • **Password**: Temporary password (they'll reset on first login)
3. Select "Assigned Clients" - which clients this vendor can service
4. Click "Create Vendor"

**What Vendors Can Do:**
• Submit service reports for their assigned clients
• View reports they've created
• Access the Service Portal

**Editing a Vendor:**
1. Find the vendor in the list
2. Click the edit (pencil) icon
3. Update their information or assigned clients
4. Click "Update Vendor"

**Deleting a Vendor:**
1. Click the delete (trash) icon next to the vendor
2. Confirm the deletion
3. NOTE: This removes their access but keeps their submitted reports

---

**ASSIGNING SERVICE VISITS:**

You can pre-assign service work to technicians or vendors with all client details filled in.

**Creating an Assignment:**
1. Go to Admin Hub → Service Portal → Service Reports tab
2. Click "Assign New Service" button
3. Fill in the assignment form:

**Required Fields:**
• **Assign To**: Select the technician/vendor
• **Client/Facility**: Select the client
• **Service Type**: Choose the service category

**Pre-fill Fields:**
• **Customer Name**: Contact person at the client
• **Address**: Service location
• **Analyzer Model/Serial**: Equipment details
• **HubSpot Ticket #**: Reference ticket
• **Service Completion Date**: Expected/scheduled date

**Manager Notes:**
Add instructions or context for the technician. They'll see this when they view the assignment.

**Uploading Photos:**
1. Click "Upload Photos"
2. Select photos showing the issue or location
3. Photos appear in the assignment for the technician to reference

**Uploading Client Files:**
1. Click "Upload Files"
2. Select documents (manuals, previous reports, etc.)
3. Files are attached for technician reference

**Submit the Assignment:**
Click "Create Assignment" - the technician will see it in their dashboard.

---

**TRACKING ASSIGNMENTS:**

**In the Service Reports Tab:**
• **Status: Assigned** (yellow) = Pending technician completion
• **Status: Submitted** (green) = Technician has completed the report

**Viewing Assignment Details:**
1. Click "View" on any report
2. See all pre-filled information
3. Once completed, see technician's work documentation

**Editing Manager Notes:**
1. Open a report/assignment
2. Find the "Manager Notes" section
3. Update notes as needed
4. Click "Save Notes"

---

**BEST PRACTICES FOR MANAGERS:**

✓ **Assign work promptly** - Technicians see assignments in real-time

✓ **Provide clear notes** - Include specific instructions and context

✓ **Upload reference materials** - Photos and files help technicians prepare

✓ **Set realistic dates** - Consider travel and complexity

✓ **Follow up on overdue assignments** - Check the reports list regularly

✓ **Review completed reports** - Ensure quality and completeness

---

**VENDOR ASSIGNMENT WORKFLOW:**

1. **Create vendor account** (Vendors tab)
2. **Assign clients** to the vendor
3. **Create service assignments** for specific client visits
4. **Monitor completion** in Service Reports tab
5. **Review submitted reports** for quality

**TROUBLESHOOTING:**

**Can't see Vendors tab?**
• Ensure you're a Manager with Service Portal access
• Log out and back in after permissions change

**Vendor can't log in?**
• Verify their email is correct
• Reset their password if needed

**Assignment not showing for technician?**
• Verify you selected the correct assignee
• Check the technician has Service Portal access`
          }
        ]
      },
      'client-portal': {
        title: 'Client Portal Admin',
        description: 'Managing client portals, content, and communications',
        icon: Icons.client,
        color: 'bg-amber-500',
        articles: [
          {
            title: 'Understanding Client Portals',
            content: `Each client organization has their own dedicated portal where they can access services, documents, and support.

**CLIENT PORTAL ARCHITECTURE:**

Each client portal is accessed at:
/portal/{client-slug}

Where {client-slug} is a unique identifier like "dallas-urology" or "austin-medical"

**WHAT CLIENTS SEE IN THEIR PORTAL:**

**1. Home Dashboard**
- Welcome message with their practice name
- Announcements from Thrive 365
- Quick links to other sections

**2. Launch Milestones** (only for active implementation projects)
- Progress through implementation phases
- Completed and upcoming milestones

**3. Inventory Management**
- Weekly inventory submission
- Stock level reports and alerts
- Expiring item warnings

**4. Customer Support Center**
- Support ticket history
- Submit new tickets
- Live chat access

**5. Files & Documents**
- Contracts and agreements
- Product inserts and documentation
- Certificates of analysis
- Their own uploads

**YOUR ROLE AS ADMIN:**
Using Client Portal Admin, you manage what clients see and access:
- Create/edit announcements
- Upload documents
- Monitor their activity
- Configure portal settings

**ACCESSING CLIENT PORTAL ADMIN:**
1. From Portal Hub, click "Client Portal" tile
2. Requires "Has Client Portal Admin Access" permission
3. Select which client you want to manage`
          },
          {
            title: 'Creating and Managing Announcements',
            content: `Announcements appear prominently on the client's home dashboard. Use them to communicate important information.

**WHEN TO USE ANNOUNCEMENTS:**
- New product information
- Service schedule changes
- Important compliance updates
- Holiday schedule notifications
- Upcoming visits or events

**CREATING AN ANNOUNCEMENT:**

**Step 1: Navigate to Announcements**
1. Go to Client Portal Admin
2. Select the client
3. Click "Announcements" tab

**Step 2: Click "New Announcement"**

**Step 3: Fill in the Details**

• **Title** (Required)
  - Keep it clear and concise
  - Example: "New Reagent Lot Now Available"

• **Content** (Required)
  - Full message text
  - Can include multiple paragraphs
  - Be specific with dates and actions needed

• **Type** - Choose the appropriate color coding:
  - **Info** (Blue) - General information, updates
  - **Warning** (Yellow/Orange) - Important notices, deadlines
  - **Success** (Green) - Good news, completions

**Step 4: Optional Settings**

• **Pinned** - Toggle ON to keep this announcement at the top
  - Use for critical, ongoing information
  - Only pin one or two announcements at a time

• **Priority** - Toggle ON for highlighted styling
  - Draws extra attention
  - Use sparingly for truly urgent items

• **Attachment** - Upload a related file
  - Client can download directly from announcement
  - Good for: schedules, guides, forms

**Step 5: Save**
Click "Create" to publish immediately

**EDITING ANNOUNCEMENTS:**
1. Find the announcement in the list
2. Click "Edit"
3. Make changes
4. Save

**DELETING ANNOUNCEMENTS:**
1. Find the announcement
2. Click "Delete"
3. Confirm

⚠️ Deleted announcements cannot be recovered

**BEST PRACTICES:**
✓ Keep announcements current - delete outdated ones
✓ Use appropriate type colors (don't make everything a "warning")
✓ Pin only critical items
✓ Include action items and deadlines clearly
✓ Review announcements monthly for relevance`
          },
          {
            title: 'Uploading and Organizing Client Documents',
            content: `The Files section allows you to share documents with clients and receive their uploads.

**DOCUMENT CATEGORIES:**

Documents are organized into categories:
• **Contracts** - Agreements, MSAs, SOWs
• **Onboarding** - Setup guides, welcome materials
• **Inserts** - Product package inserts
• **Certificates of Analysis** - COAs for reagents/supplies
• **Analyzer** - Equipment manuals, specs
• **Other** - Anything else

**UPLOADING A DOCUMENT:**

**Step 1: Navigate to Documents**
1. Go to Client Portal Admin
2. Select the client
3. Click "Documents" tab

**Step 2: Click "Upload Document"**

**Step 3: Select Your File**
Click to browse or drag and drop

**Supported Formats:**
- PDF (recommended)
- Word documents (.doc, .docx)
- Excel spreadsheets (.xls, .xlsx)
- Images (.jpg, .png)
- Text files (.txt)

**Step 4: Select Category**
Choose the appropriate category from the dropdown

**Step 5: Add Notes** (Optional)
Include context like:
- What the document is for
- Expiration date if applicable
- Version number

**Step 6: Upload**
Click "Upload" to save

**WHAT CLIENTS SEE:**
- Documents grouped by category
- File name and upload date
- Your notes (if added)
- Download button for each file

**CLIENT UPLOADS:**

Clients can also upload documents from their Files page.

**Viewing Client Uploads:**
1. Go to Documents tab
2. Look for "Client Uploads" section
3. Review uploaded files
4. These are NOT visible to the client in the main files list

**Why Clients Upload:**
- Returning signed contracts
- Submitting required documentation
- Sharing compliance records

**MANAGING DOCUMENTS:**

**Deleting a Document:**
1. Find the document in the list
2. Click "Delete"
3. Confirm

⚠️ Deleted documents are removed from client view immediately

**Updating a Document:**
There's no "edit" - instead:
1. Upload the new version
2. Delete the old version
3. Or add a note indicating which is current

**BEST PRACTICES:**
✓ Use clear, descriptive file names
✓ Include dates in file names for versioned documents
✓ Keep COAs current - delete expired ones
✓ Review client uploads promptly
✓ Organize by category consistently`
          },
          {
            title: 'Client Portal Settings and Customization',
            content: `Configure portal appearance and settings for individual clients.

**ACCESSING SETTINGS:**
1. Go to Client Portal Admin
2. Select the client
3. Click "Settings" tab

**AVAILABLE CUSTOMIZATIONS:**

**1. Practice/Organization Name**
The name displayed throughout the portal
- Appears in welcome messages
- Shows in headers
- Used in generated documents

**2. Logo**
Upload the client's logo:
- Displayed in their portal header
- Should be PNG or JPG
- Recommended size: 200×60 pixels
- Transparent background works best

**3. Banner Image**
Custom banner for their dashboard:
- Appears at top of home page
- Adds visual branding
- Recommended size: 1200×300 pixels

**4. Contact Information**
Set who they should contact:
- Primary contact name
- Email address
- Phone number
- Shows in portal footer/support sections

**APPLYING CHANGES:**
1. Make your changes
2. Click "Save Settings"
3. Changes appear immediately for the client

**PREVIEWING:**
After saving, you can view the client portal to see how it looks:
1. Note the client's portal URL
2. Open in a new tab (or incognito window)
3. Log in as a test client user (or ask client)

**BEST PRACTICES:**
✓ Get client logo before portal goes live
✓ Use professional, high-quality images
✓ Keep branding consistent with client's identity
✓ Update contact info when personnel changes
✓ Test changes after applying`
          },
          {
            title: 'Monitoring Client Activity',
            content: `How to track what clients are doing in their portal.

**WHAT YOU CAN MONITOR:**

**1. Inventory Submissions**
From Client Portal Admin > Inventory:
- See submission history
- Check last submission date
- View submitted quantities
- Identify clients who haven't submitted recently

**Warning Indicators:**
- Red banner if no submission in 7+ days
- Low stock alerts
- Expiring inventory warnings

**2. Support Tickets**
Tickets submitted by clients appear in HubSpot:
- View open tickets
- Track resolution status
- See ticket history

**3. Document Downloads**
While not directly logged, you can infer activity by:
- Checking if client references documents in support tickets
- Asking during regular communications

**4. Portal Logins**
Full login tracking is in Admin Hub:
- User Management shows last login date
- Identify inactive users

**FOLLOWING UP WITH CLIENTS:**

**Inactive Inventory Submissions:**
If a client hasn't submitted inventory in over a week:
1. Contact them to remind about weekly submission
2. Check if they're having access issues
3. Offer training if needed

**Open Support Issues:**
Regularly review tickets to ensure:
- Tickets aren't sitting unresolved
- Escalations are handled
- Client satisfaction

**PRO TIP:** Set a weekly calendar reminder to:
- Check inventory submission compliance
- Review open support tickets
- Follow up with inactive clients`
          }
        ]
      },
      'inventory': {
        title: 'Inventory Management',
        description: 'Weekly inventory updates, reports, and alerts',
        icon: Icons.inventory,
        color: 'bg-teal-600',
        articles: [
          {
            title: 'Inventory System Overview (For Internal Staff)',
            content: `The inventory system allows clients to track their reagent and supply levels. As internal staff, you need to understand how it works to support clients and monitor compliance.

**HOW THE SYSTEM WORKS:**

**1. Inventory Template**
Each client has an inventory template containing:
- List of products they use
- Expected reorder levels
- Categories for organization

**2. Weekly Submissions**
Clients are expected to submit inventory counts weekly:
- They log in to their portal
- Navigate to Inventory > Weekly Update
- Enter current quantities (open and closed)
- Add expiration dates where applicable
- Submit

**3. Automated Alerts**
The system generates alerts for:
- **Low Stock** (≤2 units): Red alerts, needs immediate reorder
- **Expiring Soon** (within 30 days): Orange alerts, use first

**YOUR RESPONSIBILITIES AS INTERNAL STAFF:**

**Monitoring Compliance:**
- Check that clients submit weekly
- Follow up if submissions are overdue (>7 days)
- Watch for patterns in low stock

**Supporting Clients:**
- Help them understand the submission process
- Assist with inventory template questions
- Explain alert thresholds

**Responding to Alerts:**
- Low stock alerts may trigger proactive outreach
- Expiring inventory may require guidance on usage priority

**ACCESSING CLIENT INVENTORY (Admin):**
1. Go to Client Portal Admin
2. Select the client
3. Click "Inventory" tab
4. View their submissions and current levels`
          },
          {
            title: 'Reading Inventory Reports',
            content: `How to interpret client inventory data and reports.

**REPORTS & ALERTS PAGE:**

This page (visible to both clients and admins) shows current inventory status.

**UNDERSTANDING THE SECTIONS:**

**1. Low Stock Alerts (Red)**
- Items where Open Qty + Closed Qty ≤ 2
- These are CRITICAL - risk of stockout
- Action: Contact client about reordering
- Example: If a client has 1 open and 1 closed of a reagent, they'll stockout soon

**2. Expiring Soon (Orange)**
- Items with expiration within 30 days
- These should be used first
- Action: Remind client to use before expiration
- May need to plan replacement orders

**3. Current Stock Levels (Blue)**
- All items with current quantities
- Shows breakdown: Open vs Closed
- Filter by category
- Search for specific items

**READING THE DATA:**

For each item you'll see:
• **Item Name**: Product name
• **Category**: Type of product
• **Open Qty**: Units currently in use/opened
• **Closed Qty**: Sealed, unopened units
• **Expiration Date**: If reported
• **Total**: Open + Closed combined

**INTERPRETING PATTERNS:**

High Open, Low Closed:
- Client is using product but not stocking replacement
- May need to reorder soon

High Closed, Low Open:
- Well-stocked but may indicate slow usage
- Watch expiration dates

Consistently Low Totals:
- Client may be ordering just-in-time
- Higher risk of stockout

No Recent Submissions:
- Client may have forgotten
- Could indicate access issues
- Follow up needed

**EXPORTING DATA:**
Click "Download CSV" to export inventory data:
- Use for analysis
- Share with account teams
- Create reports`
          },
          {
            title: 'Managing Inventory Templates',
            content: `How inventory templates work and how to modify them for clients.

**WHAT IS AN INVENTORY TEMPLATE?**

The template defines which items appear in a client's inventory submission form:
- Product names
- Categories
- Expected items for their account

**DEFAULT TEMPLATE:**
New clients start with a standard template. You can customize it for each client.

**VIEWING A CLIENT'S TEMPLATE:**
1. Go to Admin Hub
2. Navigate to inventory settings
3. Select the client
4. View their item list

**ADDING ITEMS TO A TEMPLATE:**

**Step 1: Navigate to Template Management**
1. Find the client's template
2. Click "Add Item"

**Step 2: Enter Item Details**
• **Item Name**: Exact product name
• **Category**: Select or create category
• **Notes**: Optional additional info

**Step 3: Save**
Item appears in client's submission form

**REMOVING ITEMS:**
1. Find the item in the template
2. Click "Remove"
3. Item no longer appears for submission
4. Historical data is preserved

**CUSTOM ITEMS:**
Clients can add their own items:
- They click "Add Custom Item" in their portal
- These are specific to that client
- You can see them in admin view

**CATEGORIES:**
Items are grouped by category:
- Reagents
- Calibrators
- Controls
- Consumables
- Etc.

Keep categories consistent across clients when possible.

**BEST PRACTICES:**
✓ Set up templates before client goes live
✓ Include all products client uses
✓ Use consistent naming
✓ Review templates annually for accuracy
✓ Remove discontinued products`
          },
          {
            title: 'Troubleshooting Inventory Issues',
            content: `Common inventory problems and how to resolve them.

**PROBLEM: Client Says Form Is Empty**
Cause: No inventory template set up
Solution:
1. Check if template exists in admin
2. Create template if missing
3. Add all appropriate items

**PROBLEM: Client Can't Submit**
Causes & Solutions:
1. Check they're logged in correctly
2. Verify inventory section is enabled
3. Ensure all required fields are filled
4. Try different browser/clear cache

**PROBLEM: Submission Shows Old Data**
Cause: Client viewing cached page
Solution: Client should refresh browser (Ctrl+F5)

**PROBLEM: Alerts Not Accurate**
Causes:
1. Old submission data (client hasn't submitted recently)
2. Expiration dates not entered
3. Quantities entered incorrectly

Solution:
1. Confirm client is submitting weekly
2. Ask them to verify and resubmit

**PROBLEM: Missing Items**
Cause: Item not in template
Solution: Add item to client's template

**PROBLEM: Duplicate Items**
Cause: Item added multiple times
Solution:
1. Identify duplicates
2. Remove the duplicate entries
3. Ask client to resubmit

**PROBLEM: Client Can't Find Submission History**
Solution: Guide them to:
1. Inventory section
2. "History" or "Past Submissions" tab
3. Filter by date if needed

**GETTING HELP:**
For technical issues beyond these solutions:
1. Document the exact error
2. Note the client and steps to reproduce
3. Submit bug report through Admin Hub inbox`
          }
        ]
      },
      'customer-support': {
        title: 'Customer Support Center',
        description: 'Tickets, live chat, and support resources',
        icon: Icons.support,
        color: 'bg-sky-600',
        articles: [
          {
            title: 'Support Center Overview',
            content: `The Customer Support Center provides multiple ways to get help.

**Three Support Options:**
1. **Ticket History**: View your past and current support tickets
2. **Submit a Ticket**: Create a new support request
3. **Live Chat**: Chat with support agents in real time

**Accessing Support:**
Navigate to Customer Support from the sidebar menu.`
          },
          {
            title: 'Viewing Ticket History',
            content: `See all your support tickets in one place.

**Ticket Information:**
- Subject/title
- Creation date
- Current status
- Resolution notes (when resolved)

**Ticket Statuses:**
- **New**: Just submitted
- **In Progress**: Being worked on
- **Assigned**: Assigned to a specific agent
- **Vendor Escalation**: Escalated to vendor support
- **Resolved**: Issue resolved
- **Closed**: Ticket closed

**Viewing Details:**
Click on any ticket to expand and see:
- Full description
- Resolution notes
- Attached files (including service reports)

**Attachments:**
Service reports submitted by technicians appear as downloadable attachments on related tickets.`
          },
          {
            title: 'Submitting a Ticket',
            content: `Create a new support request for any issues or questions.

**How to Submit:**
1. Click the "Submit a Ticket" tab
2. Fill out the support form with:
   - Subject
   - Description of your issue
   - Priority level
   - Any relevant attachments
3. Submit the form

**Response Time:**
Expect a response within 24-48 hours for standard requests.

**Alternative Contact:**
You can also email support directly at support@thrive365labs.live`
          },
          {
            title: 'Using Live Chat',
            content: `Get real-time help from support agents.

**Starting a Chat:**
1. Click the "Live Chat" tab
2. Click "Start Chat Now" button
3. Or use the chat icon in the bottom-right corner

**Chat Availability:**
Support agents are available during business hours. The green indicator shows when agents are online.

**Best For:**
- Quick questions
- Urgent issues
- Real-time troubleshooting`
          }
        ]
      },
      'files': {
        title: 'Files & Documents',
        description: 'Document management and file uploads',
        icon: Icons.files,
        color: 'bg-violet-600',
        articles: [
          {
            title: 'Accessing Documents',
            content: `The Files page shows all documents shared with you.

**Document Categories:**
- Contracts
- Onboarding
- Inserts
- Certificates of Analysis
- Analyzer
- Other

**Downloading Files:**
Click on any document to download it to your device.`
          },
          {
            title: 'Uploading Documents',
            content: `Clients can upload documents for admin review.

**How to Upload:**
1. Navigate to Files
2. Click "Upload File"
3. Select your file
4. Choose a category
5. Add optional notes
6. Upload

**Supported Files:**
Most common file types are supported including PDF, Word, Excel, and images.

**Where Files Go:**
Uploaded files appear in the "Your Uploads" section and are also visible to administrators.

**HubSpot Integration:**
If configured, uploaded files are automatically attached to your HubSpot company/deal record.`
          }
        ]
      },
      'technical-docs': {
        title: 'Technical Documentation',
        description: 'System architecture, API reference, and developer resources',
        icon: Icons.code,
        color: 'bg-slate-700',
        ownerOnly: true,
        articles: [
          {
            title: 'System Overview',
            content: `Thrive 365 Labs Web App is a comprehensive multi-project launch tracker designed for managing complex clinical laboratory equipment installations.

**Key Features:**
- 102-task template for Biolis AU480 CLIA lab setups
- Robust admin controls and team member accounts
- Embeddable, authenticated client portals for external stakeholders
- Service Portal for field service engineers and clinical application specialists
- HubSpot CRM integration for seamless deal tracking and file management
- Google Drive integration for document storage

**Technology Stack:**
- Backend: Express.js REST API
- Frontend: React 18 (CDN-loaded), Babel standalone for JSX
- Styling: Tailwind CSS (CDN)
- Database: Replit Database (key-value store)
- Authentication: JWT tokens, bcryptjs password hashing
- PDF Generation: PDFKit, PDFMake

**System Design Principles:**
- Modularity: Clear separation of frontend and backend concerns
- Scalability: CDN-based frontend delivery and flexible key-value data storage
- Security: JWT-based authentication, bcrypt password hashing, role-based access control
- User Experience: Streamlined workflows, intuitive reporting, and client-facing transparency`
          },
          {
            title: 'Application Portals',
            content: `The application consists of multiple interconnected portals, each serving different user roles:

**1. Unified Login Portal (/login)**
Central authentication hub where users log in once and access all portals they have permissions for.

**2. Admin Hub (/admin)**
Administrative dashboard for system management:
- User management with granular permissions
- Dashboard statistics and quick actions
- Feedback/bug report inbox
- Bulk password reset functionality
- Activity logging and system settings

**3. Launch App (/launch/home)**
Project implementation tracking for internal teams:
- Project boards with task management
- 102-task template system
- HubSpot synchronization
- Soft-pilot checklist generation
- Launch reports and analytics
- Implementations calendar

**4. Client Portal (/portal/{slug})**
Authenticated client-facing portal:
- Home dashboard with announcements
- Launch milestones and progress tracking
- Inventory management with weekly updates
- Customer support with HubSpot ticket integration
- Files and documents section

**5. Service Portal (/service-portal)**
Dedicated portal for field service engineers and CAS:
- Service report creation and management
- Validation reports (Phase 3)
- Digital signature capture
- PDF generation and export
- HubSpot ticket auto-creation

**6. Knowledge Hub (/knowledge)**
Resource center with how-to guides, documentation, and link directory.

**7. Changelog (/changelog)**
Version history and release notes for the application.`
          },
          {
            title: 'User Management & Permissions',
            content: `The application uses a role-based access control system with granular permission flags.

**User Roles:**
- Admin: Full system access
- Team Member: Internal staff with configurable permissions
- Client: Client portal users tied to a specific practice
- Vendor: External service providers with limited, client-specific access

**Permission Flags:**
- hasServicePortalAccess: Service Portal access
- hasAdminHubAccess: Admin Hub access
- hasImplementationsAccess: Implementation App access
- hasClientPortalAdminAccess: Client Portal admin features
- assignedClients: Array for vendor client assignments

**Authentication Features:**
- JWT-based authentication with secure token management
- Password reset system with admin approval workflow
- Bulk password reset with first-login change prompt
- Forgot password request system`
          },
          {
            title: 'Project & Task Management',
            content: `The Launch App provides comprehensive project and task management.

**102-Task Biolis AU480 CLIA Template:**
Industry-standard workflow for clinical laboratory equipment installations.

**Task Features:**
- Per-stage task addition
- Email-based owner assignment
- Subtasks with completion enforcement
- Task descriptions and notes
- Due dates with timeline sorting
- Task reordering within stages
- File attachments (PDF, images, Word, Excel, text)
- Tagging system with global tag library
- Bulk operations (update, delete)

**Additional Features:**
- Project cloning for rapid duplication
- CSV import/export for bulk task management
- Template system for reusable project structures
- Project notes log with aggregated view`
          },
          {
            title: 'API Reference - Authentication',
            content: `Authentication API endpoints for user login and management.

**POST /api/auth/login**
User login - returns JWT token and user data

**POST /api/auth/signup**
User registration - creates new user account

**POST /api/auth/client-login**
Client portal login - authenticates client users

**POST /api/auth/service-login**
Service portal login - authenticates service personnel

**POST /api/auth/admin-login**
Admin hub login - authenticates admin users

**POST /api/auth/forgot-password**
Password reset request - sends reset notification to admin

**POST /api/auth/change-password**
Change user password - updates password for authenticated user`
          },
          {
            title: 'API Reference - Projects & Tasks',
            content: `Project and task management API endpoints.

**Projects:**
- GET /api/projects - List all projects
- POST /api/projects - Create new project
- GET /api/projects/:id - Get project details
- PUT /api/projects/:id - Update project
- DELETE /api/projects/:id - Delete project
- POST /api/projects/:id/clone - Clone project
- GET /api/projects/:id/export - Export project data

**Tasks:**
- GET /api/projects/:id/tasks - List project tasks
- POST /api/projects/:id/tasks - Create task
- PUT /api/projects/:projectId/tasks/:taskId - Update task
- DELETE /api/projects/:projectId/tasks/:taskId - Delete task
- POST /api/projects/:projectId/tasks/:taskId/reorder - Reorder task
- PUT /api/projects/:projectId/tasks/bulk-update - Bulk update tasks
- POST /api/projects/:projectId/tasks/bulk-delete - Bulk delete tasks

**Subtasks:**
- POST /api/projects/:projectId/tasks/:taskId/subtasks - Create subtask
- PUT /api/projects/:projectId/tasks/:taskId/subtasks/:subtaskId - Update subtask
- DELETE /api/projects/:projectId/tasks/:taskId/subtasks/:subtaskId - Delete subtask

**Notes & Files:**
- POST /api/projects/:projectId/tasks/:taskId/notes - Add note
- PUT /api/projects/:projectId/tasks/:taskId/notes/:noteId - Update note
- DELETE /api/projects/:projectId/tasks/:taskId/notes/:noteId - Delete note
- POST /api/projects/:projectId/tasks/:taskId/files - Upload file
- DELETE /api/projects/:projectId/tasks/:taskId/files/:fileId - Delete file`
          },
          {
            title: 'API Reference - Users & Templates',
            content: `User management and template API endpoints.

**User Management (Admin):**
- GET /api/users - List all users
- POST /api/users - Create user
- PUT /api/users/:userId - Update user
- DELETE /api/users/:userId - Delete user
- GET /api/team-members - List team members
- POST /api/admin/bulk-password-reset - Bulk password reset

**Templates:**
- GET /api/templates - List templates
- POST /api/templates - Create template
- GET /api/templates/:id - Get template
- PUT /api/templates/:id - Update template
- DELETE /api/templates/:id - Delete template
- POST /api/templates/:id/clone - Clone template
- POST /api/templates/:id/import-csv - Import CSV to template
- PUT /api/templates/:id/set-default - Set as default template`
          },
          {
            title: 'API Reference - Inventory & Service Portal',
            content: `Inventory management and service portal API endpoints.

**Inventory:**
- GET /api/inventory/template - Get inventory template
- PUT /api/inventory/template - Update inventory template
- GET /api/inventory/submissions/:slug - Get submissions history
- GET /api/inventory/latest/:slug - Get latest submission
- POST /api/inventory/submit - Submit inventory update
- GET /api/inventory/report/:slug - Get inventory report
- GET /api/inventory/export/:slug - Export inventory CSV
- GET /api/inventory/custom-items/:slug - Get custom items
- POST /api/inventory/custom-items/:slug - Add custom item
- DELETE /api/inventory/custom-items/:slug/:itemId - Delete custom item

**Service Portal:**
- GET /api/service-portal/data - Get portal data
- GET /api/service-portal/clients - Get assigned clients
- POST /api/service-reports - Create service report
- GET /api/service-reports - List service reports
- GET /api/service-reports/:id - Get service report
- PUT /api/service-reports/:id - Update service report
- DELETE /api/service-reports/:id - Delete service report
- POST /api/validation-reports - Create validation report
- GET /api/validation-reports - List validation reports
- GET /api/validation-reports/:id - Get validation report
- PUT /api/validation-reports/:id - Update validation report`
          },
          {
            title: 'API Reference - HubSpot Integration',
            content: `HubSpot CRM integration API endpoints.

**HubSpot Endpoints:**
- GET /api/hubspot/test - Test HubSpot connection
- GET /api/hubspot/pipelines - Get deal pipelines
- GET /api/hubspot/deals - Get deals
- GET /api/hubspot/record/:recordId - Get HubSpot record
- GET /api/hubspot/stage-mapping - Get stage mapping
- PUT /api/hubspot/stage-mapping - Update stage mapping
- POST /api/hubspot/upload-to-deal - Upload file to deal
- POST /api/projects/:id/hubspot-sync - Sync project to HubSpot
- POST /api/projects/:id/soft-pilot-checklist - Generate soft-pilot checklist

**Integration Features:**
- OAuth-based configuration for secure authentication
- Deal pipeline sync with stage mapping
- Task completion notes sync
- Stage progression tracking
- File uploads to Company, Deal, Contact records
- HubSpot ticket integration for customer support
- Chatbot embed for live chat support
- Webhook endpoint for form submissions
- Idempotent sync with stored HubSpot IDs to prevent duplicates`
          },
          {
            title: 'External Dependencies & Environment',
            content: `Third-party services and configuration requirements.

**Third-Party Services:**
- HubSpot: CRM integration for deal pipeline, client profiles, ticket management, and file storage
- Google Drive: Storage for soft-pilot checklist uploads and document management
- Replit Database: Primary data persistence (key-value store)

**NPM Packages:**
- @hubspot/api-client: ^13.4.0
- @replit/database: ^2.0.5
- axios: ^1.13.2
- bcryptjs: ^2.4.3
- body-parser: ^1.20.2
- cors: ^2.8.5
- express: ^4.18.2
- form-data: ^4.0.5
- googleapis: ^169.0.0
- jsonwebtoken: ^9.0.2
- multer: ^2.0.2
- pdfkit: ^0.17.2
- pdfmake: ^0.3.3
- uuid: ^9.0.0

**CDN Dependencies (Frontend):**
- React 18 / ReactDOM 18
- Babel standalone (JSX transpilation)
- Tailwind CSS
- Heroicons v2

**Environment Variables:**
- PORT: Server port (default: 3000) - Optional
- JWT_SECRET: Secret key for JWT token signing - Required
- HUBSPOT_WEBHOOK_SECRET: Secret for HubSpot webhook validation - Optional
- HUBSPOT_PRIVATE_APP_TOKEN: HubSpot private app token for API access - Required
- GOOGLE_SERVICE_ACCOUNT_KEY: Google service account credentials (JSON) - Optional`
          },
          {
            title: 'Project Structure',
            content: `File organization and directory structure.

**Root Directory:**
- server.js: Main Express server with API routes
- hubspot.js: HubSpot integration module
- googledrive.js: Google Drive integration module
- pdf-generator.js: PDF generation utilities
- changelog-generator.js: Automated changelog generation
- package.json: Dependencies and scripts
- template-biolis-au480-clia.json: Default task template

**Public Directory (/public):**
- index.html: Root HTML
- login.html: Unified login portal
- admin-hub.html: Admin dashboard
- app.js: Main React application
- portal.html: Client portal
- service-portal.html: Service portal
- client.html: Legacy client view
- knowledge.html: Knowledge hub
- link-directory.html: Resource links
- changelog.html: Version history viewer
- changelog.md: Markdown changelog

**Static Assets:**
- attached_assets/: Static assets directory
- banners/: Banner images
- thrive365-logo.webp: Logo file

**Deployment:**
1. Import the project to Replit
2. Configure environment secrets in Replit Secrets
3. Click "Run" to start the application
4. Configure custom domain if needed

The application supports custom domains for main application access and client portal URLs (e.g., launch.yourdomain.com/{slug}).`
          }
        ]
      },
      'admin-guide': {
        title: 'Admin Guide',
        description: 'Key tips, best practices, and advanced features for system administrators',
        icon: Icons.admin,
        color: 'bg-rose-600',
        adminOnly: true,
        articles: [
          {
            title: 'Admin Hub Best Practices',
            content: `Essential tips for effectively managing the Admin Hub.

**Dashboard Overview:**
The Admin Hub dashboard is your command center. Use the quick stats section to monitor:
- Active implementation projects (New Launches count)
- Pending items requiring attention (Open Tickets)

**Inbox Management Tips:**
1. Check the inbox at least once daily
2. Prioritize password reset requests - users are blocked until resolved
3. Track bug reports for patterns that may indicate system issues
4. Use feature requests to inform development priorities

**Quick Actions:**
- Navigate directly to User Management from the dashboard
- Access system statistics for a high-level overview
- View the changelog to stay informed about updates

**Best Practice:** Set a daily routine to review the inbox first thing in the morning.`
          },
          {
            title: 'User Management Deep Dive',
            content: `Advanced user management techniques and strategies.

**User Role Selection Guide:**
- **Admin**: Reserve for system owners and IT administrators only
- **Team Member**: Most internal staff - use permission toggles for fine-grained control
- **Client**: Always assign to a specific practice/client
- **Vendor**: External service providers - limit to assigned clients only

**Permission Strategy:**
Think about least-privilege access:
1. Start with minimal permissions
2. Add access as needed based on job function
3. Review permissions quarterly

**Manager Flag:**
The "Is Manager" toggle gives limited Admin Hub access without full admin privileges. Use for:
- Team leads who need to view dashboard stats
- Supervisors who need to manage service portal

**Bulk Operations Tips:**
1. Use search to filter users first
2. Select multiple users with checkboxes
3. Bulk password reset sends emails with temporary passwords
4. Users will be prompted to change password on first login

**Security Tip:** Always verify email addresses before creating accounts to prevent unauthorized access.`
          },
          {
            title: 'Reporting & Analytics',
            content: `Understanding and using reports effectively across the system.

**Admin Hub Dashboard Stats:**
- **New Launches**: Count of active (non-complete) implementation projects
- **Open Tickets**: Sum of unresolved feedback, bugs, and password reset requests

**Service Portal Reports:**
Service reports are automatically synced to HubSpot:
1. PDF generated on submission
2. Ticket created in HubSpot
3. Attached to client's company record
4. Visible in client's Customer Support Center

**Launch App Reports:**
From the Launch App, you can:
- Export soft-pilot checklists to Google Drive
- Generate project status reports
- View task completion analytics

**Inventory Reports (Client Portal):**
Monitor client inventory through:
- Low stock alerts (2 or fewer items)
- Expiring soon warnings (30 days)
- Weekly submission compliance
- CSV export for external analysis

**Pro Tip:** Set up regular report reviews (weekly for inventory, monthly for projects) to catch issues early.`
          },
          {
            title: 'HubSpot Integration Management',
            content: `Managing the HubSpot CRM integration effectively.

**What Syncs Automatically:**
1. Service reports create HubSpot tickets
2. Files uploaded sync to company/deal records
3. Support tickets from portal appear in HubSpot
4. Deal pipeline stages can be mapped to project stages

**Troubleshooting Sync Issues:**
- Check the HUBSPOT_PRIVATE_APP_TOKEN is valid
- Verify the HubSpot company/deal record exists
- Review server logs for API errors
- Test connection using /api/hubspot/test endpoint

**Best Practices:**
1. Keep HubSpot company records up to date
2. Use consistent naming conventions
3. Map project stages to deal stages for accurate pipeline views
4. Review sync status after major updates

**Important:** Changes made directly in HubSpot may not reflect in the portal. Always make primary changes in the portal.`
          },
          {
            title: 'Troubleshooting Common Issues',
            content: `Quick solutions for frequently encountered problems.

**User Can't Login:**
1. Verify email is correct (case-sensitive)
2. Check if password reset is needed
3. Confirm user account exists and is active
4. Clear browser cache/cookies

**Service Portal Issues:**
1. Ensure user has "Has Service Portal Access" permission
2. Verify they're using the correct login
3. Check if they have assigned clients (for vendors)

**Client Portal Issues:**
1. Confirm client user is assigned to correct practice
2. Verify the practice slug is correct
3. Check if the client portal is enabled

**Inventory Not Showing:**
1. Ensure inventory template exists for the client
2. Verify client has submitted at least one update
3. Check browser console for JavaScript errors

**HubSpot Not Syncing:**
1. Verify HubSpot API token is valid
2. Check server logs for error messages
3. Confirm company/deal record exists in HubSpot
4. Test API connection

**General Tips:**
- Always check browser console (F12) for JavaScript errors
- Clear browser cache when experiencing display issues
- Verify user permissions are correctly assigned
- Check server logs for API errors`
          },
          {
            title: 'Security & Access Control',
            content: `Security best practices for system administrators.

**Password Policies:**
- Minimum 8 characters required
- Encourage mix of letters, numbers, symbols
- Force password change on first login for new users
- Process password reset requests promptly

**Session Management:**
- JWT tokens expire after 24 hours
- Users must re-authenticate after token expiry
- Tokens stored in browser localStorage
- Logout clears all stored tokens

**Permission Auditing:**
Regularly review:
1. Who has Admin access
2. Which vendors have client access
3. Team member permission levels
4. Inactive user accounts

**Security Checklist:**
- [ ] Review admin accounts quarterly
- [ ] Audit vendor access monthly
- [ ] Remove access for departed employees immediately
- [ ] Monitor for unusual login patterns
- [ ] Keep environment variables secure

**Emergency Procedures:**
If you suspect unauthorized access:
1. Change affected user passwords immediately
2. Review recent activity in the system
3. Check HubSpot for unexpected changes
4. Update JWT_SECRET if token compromise suspected
5. Notify affected clients if their data was accessed`
          }
        ]
      }
    };

    // ═══════════════════════════════════════════════════════
    // V2 API HELPERS & SEED TRANSFORM
    // ═══════════════════════════════════════════════════════

    const V2_VISIBILITY = {
      'portal-hub': ['public', 'superAdmin', 'manager', 'teamMember', 'vendor', 'client'],
      'admin-hub': ['superAdmin', 'manager', 'teamMember'],
      'launch-app': ['superAdmin', 'manager', 'teamMember'],
      'service-portal': ['superAdmin', 'manager', 'teamMember', 'vendor'],
      'client-portal': ['superAdmin', 'manager', 'teamMember'],
      'inventory': ['superAdmin', 'manager', 'teamMember', 'client'],
      'customer-support': ['public', 'superAdmin', 'manager', 'teamMember', 'vendor', 'client'],
      'files': ['public', 'superAdmin', 'manager', 'teamMember', 'vendor', 'client'],
      'technical-docs': ['superAdmin'],
      'admin-guide': ['superAdmin']
    };

    const ICON_KEY_MAP = {
      'portal-hub': 'hub', 'admin-hub': 'admin', 'launch-app': 'launch',
      'service-portal': 'service', 'client-portal': 'client', 'inventory': 'inventory',
      'customer-support': 'support', 'files': 'files', 'technical-docs': 'code', 'admin-guide': 'admin'
    };

    function transformGuidesToV2Seed(guidesObj) {
      return Object.entries(guidesObj).map(([key, guide], idx) => ({
        key,
        title: guide.title,
        description: guide.description,
        icon: ICON_KEY_MAP[key] || 'book',
        color: guide.color,
        sortOrder: idx,
        visibleTo: V2_VISIBILITY[key] || ['superAdmin'],
        features: guide.articles.map((article, aIdx) => ({
          title: article.title,
          slug: article.title.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/-+$/,''),
          sortOrder: aIdx,
          visibleTo: V2_VISIBILITY[key] || ['superAdmin'],
          tags: [key],
          content: {
            whatItIs: (article.content.split('\n').find(l => l.trim().length > 10) || '').replace(/\*\*/g, '').trim(),
            howToUseIt: article.content
          },
          knownIssues: ''
        }))
      }));
    }

    async function seedV2IfNeeded(token, isAdmin) {
      try {
        const check = await fetch('/api/knowledge/v2/needs-seed', {
          headers: token ? { 'Authorization': 'Bearer ' + token } : {}
        }).then(r => r.json());
        if (check.needsSeed && isAdmin) {
          const sections = transformGuidesToV2Seed(guides);
          await fetch('/api/knowledge/v2/seed', {
            method: 'POST',
            headers: { 'Authorization': 'Bearer ' + token, 'Content-Type': 'application/json' },
            body: JSON.stringify({ sections })
          });
        }
      } catch (e) { console.warn('V2 seed check failed:', e); }
    }

    async function fetchV2Sections(token) {
      try {
        const res = await fetch('/api/knowledge/v2/sections', {
          headers: token ? { 'Authorization': 'Bearer ' + token } : {}
        });
        const data = await res.json();
        return data.sections || [];
      } catch (e) {
        console.warn('V2 fetch failed, using local data:', e);
        return [];
      }
    }

    async function searchV2(token, query) {
      if (!query || query.trim().length < 2) return [];
      try {
        const res = await fetch('/api/knowledge/v2/search?q=' + encodeURIComponent(query), {
          headers: token ? { 'Authorization': 'Bearer ' + token } : {}
        });
        const data = await res.json();
        return data.results || [];
      } catch (e) { return []; }
    }

    // ═══════════════════════════════════════════════════════
    // CONTENT RENDERING
    // ═══════════════════════════════════════════════════════

    // Helper function to render text with inline bold formatting
    const renderTextWithBold = (text) => {
      const parts = [];
      let remaining = text;
      let key = 0;

      while (remaining.length > 0) {
        const boldStart = remaining.indexOf('**');

        if (boldStart === -1) {
          // No more bold text, add the rest
          parts.push(<span key={key++}>{remaining}</span>);
          break;
        }

        // Add text before bold
        if (boldStart > 0) {
          parts.push(<span key={key++}>{remaining.substring(0, boldStart)}</span>);
        }

        // Find the closing **
        const boldEnd = remaining.indexOf('**', boldStart + 2);

        if (boldEnd === -1) {
          // No closing **, treat ** as regular text
          parts.push(<span key={key++}>{remaining}</span>);
          break;
        }

        // Add bold text
        const boldText = remaining.substring(boldStart + 2, boldEnd);
        parts.push(<strong key={key++} className="font-semibold text-gray-900">{boldText}</strong>);

        // Continue with remaining text
        remaining = remaining.substring(boldEnd + 2);
      }

      return parts;
    };

    // Expandable Guide Section Component
    const GuideSection = ({ guide, isAdmin, sectionKey }) => {
      const [isOpen, setIsOpen] = useState(false);
      const [openArticle, setOpenArticle] = useState(null);

      // Determine border styling based on access level
      const getBorderClass = () => {
        if (guide.ownerOnly) return 'border-amber-200 ring-1 ring-amber-100';
        if (guide.adminOnly) return 'border-rose-200 ring-1 ring-rose-100';
        return 'border-gray-100';
      };

      return (
        <div data-section-key={sectionKey} className={`bg-white rounded-xl shadow-sm border overflow-hidden mb-4 ${getBorderClass()}`}>
          <button
            onClick={() => setIsOpen(!isOpen)}
            className="w-full p-5 flex items-center justify-between hover:bg-gray-50 transition"
          >
            <div className="flex items-center gap-4">
              <div className={`inline-flex items-center justify-center w-12 h-12 ${guide.color} text-white rounded-xl`}>
                {guide.icon}
              </div>
              <div className="text-left">
                <div className="flex items-center gap-2">
                  <h3 className="text-lg font-semibold text-accent">{guide.title}</h3>
                  {guide.ownerOnly && (
                    <span className="inline-flex items-center gap-1 px-2 py-0.5 bg-amber-100 text-amber-700 text-xs font-medium rounded-full">
                      {Icons.lock}
                      Admin Only
                    </span>
                  )}
                  {guide.adminOnly && (
                    <span className="inline-flex items-center gap-1 px-2 py-0.5 bg-rose-100 text-rose-700 text-xs font-medium rounded-full">
                      {Icons.lock}
                      Super Admin
                    </span>
                  )}
                </div>
                <p className="text-gray-500 text-sm">{guide.description}</p>
              </div>
            </div>
            <div className={`text-gray-400 transition-transform ${isOpen ? 'rotate-180' : ''}`}>
              {Icons.chevronDown}
            </div>
          </button>

          <div className={`guide-content ${isOpen ? 'open' : ''}`}>
            <div className="border-t border-gray-100 p-4 bg-gray-50">
              <p className="text-sm text-gray-500 mb-3">{guide.articles.length} article{guide.articles.length !== 1 ? 's' : ''}</p>
              <div className="space-y-2">
                {guide.articles.map((article, idx) => (
                  <div key={idx} className="bg-white rounded-lg border border-gray-200 overflow-hidden">
                    <button
                      onClick={() => setOpenArticle(openArticle === idx ? null : idx)}
                      className="w-full p-4 flex items-center justify-between hover:bg-gray-50 transition text-left"
                    >
                      <span className="font-medium text-gray-800">{article.title}</span>
                      <span className={`text-gray-400 transition-transform ${openArticle === idx ? 'rotate-90' : ''}`}>
                        {Icons.chevronRight}
                      </span>
                    </button>
                    {openArticle === idx && (
                      <div className="px-4 pb-4 border-t border-gray-100 bg-gray-50">
                        <div className="prose prose-sm max-w-none mt-4 text-gray-600">
                          {article.content.split('\n').map((line, pIdx) => {
                            const trimmed = line.trim();

                            // Skip empty lines
                            if (trimmed === '') {
                              return <div key={pIdx} className="h-2" />;
                            }

                            // Handle section headers (lines starting and ending with **)
                            if (trimmed.match(/^\*\*[A-Z][^*]+:?\*\*$/)) {
                              const text = trimmed.replace(/\*\*/g, '');
                              return <h4 key={pIdx} className="font-bold text-gray-900 mt-6 mb-3 text-base">{text}</h4>;
                            }

                            // Handle step headers like "**STEP 1:**"
                            if (trimmed.match(/^\*\*STEP \d+:/)) {
                              const text = trimmed.replace(/\*\*/g, '');
                              return <h5 key={pIdx} className="font-bold text-gray-800 mt-4 mb-2">{text}</h5>;
                            }

                            // Handle bulleted lists
                            if (trimmed.startsWith('• ') || trimmed.startsWith('- ')) {
                              const text = trimmed.substring(2);
                              return <li key={pIdx} className="ml-6 mb-1 list-disc">{renderTextWithBold(text)}</li>;
                            }

                            // Handle numbered lists
                            if (trimmed.match(/^\d+\.\s/)) {
                              const text = trimmed.substring(trimmed.indexOf('.') + 2);
                              return <li key={pIdx} className="ml-6 mb-1 list-decimal">{renderTextWithBold(text)}</li>;
                            }

                            // Handle checkboxes
                            if (trimmed.startsWith('- [ ]') || trimmed.startsWith('- [x]')) {
                              const checked = trimmed.includes('[x]');
                              const text = trimmed.substring(trimmed.indexOf(']') + 2);
                              return (
                                <div key={pIdx} className="flex items-center gap-2 mb-1 ml-4">
                                  <input type="checkbox" checked={checked} readOnly className="rounded" />
                                  <span>{renderTextWithBold(text)}</span>
                                </div>
                              );
                            }

                            // Regular paragraphs with inline bold support
                            return <p key={pIdx} className="mb-2 leading-relaxed">{renderTextWithBold(line)}</p>;
                          })}
                        </div>
                      </div>
                    )}
                  </div>
                ))}
              </div>
            </div>
          </div>
        </div>
      );
    };

    const App = () => {
      // Check multiple token sources for authentication
      const [token, setToken] = useState(() => {
        return localStorage.getItem('unified_token') || localStorage.getItem('admin_token') || localStorage.getItem('token');
      });
      const [user, setUser] = useState(() => {
        try {
          const userData = localStorage.getItem('unified_user') || localStorage.getItem('admin_user') || localStorage.getItem('user');
          return userData ? JSON.parse(userData) : null;
        } catch {
          return null;
        }
      });

      // State for dynamic guides from API
      const [apiGuides, setApiGuides] = useState([]);
      const [loading, setLoading] = useState(true);

      // Search state
      const [searchQuery, setSearchQuery] = useState('');
      const [searchResults, setSearchResults] = useState([]);
      const [showSearchResults, setShowSearchResults] = useState(false);
      const searchTimer = React.useRef(null);

      // Check if user is admin
      const isAdmin = user?.role === 'admin' || user?.isAdmin === true;

      // Check if user is the system owner (hidden failsafe)
      const isOwner = user?.email?.toLowerCase() === 'bianca@thrive365labs.live';

      // Seed v2 data and fetch sections on mount
      useEffect(() => {
        const init = async () => {
          try {
            // Seed v2 data if needed (also seeds v1 for backwards compat)
            await seedV2IfNeeded(token, isAdmin);

            // Also seed v1 if needed (existing behavior)
            if (token) {
              const seedCheck = await fetch('/api/knowledge/needs-seed', {
                headers: { 'Authorization': 'Bearer ' + token }
              }).then(r => r.json()).catch(() => ({ needsSeed: false }));
              if (seedCheck.needsSeed && isAdmin) {
                const guidesArray = Object.entries(guides).map(([key, guide]) => ({
                  key, title: guide.title, description: guide.description,
                  icon: guide.icon ? 'custom' : 'book', color: guide.color,
                  ownerOnly: guide.ownerOnly || false, adminOnly: guide.adminOnly || false,
                  articles: guide.articles
                }));
                await fetch('/api/knowledge/seed', {
                  method: 'POST',
                  headers: { 'Authorization': 'Bearer ' + token, 'Content-Type': 'application/json' },
                  body: JSON.stringify({ guides: guidesArray })
                }).catch(() => {});
              }
            }

            // Fetch from v2 API first, fall back to v1
            let v2Sections = await fetchV2Sections(token);
            if (v2Sections.length > 0) {
              // Map v2 sections to display format
              const mapped = v2Sections.map(s => [s.key, {
                ...s,
                icon: Icons[s.icon || ICON_KEY_MAP[s.key]] || Icons.book,
                articles: (s.features || []).map(f => ({
                  title: f.title,
                  content: f.content?.howToUseIt || f.content?.whatItIs || ''
                }))
              }]);
              setApiGuides(mapped);
            } else if (token) {
              // Fall back to v1 API
              const response = await fetch('/api/knowledge/guides', {
                headers: { 'Authorization': 'Bearer ' + token }
              });
              const data = await response.json();
              if (Array.isArray(data)) {
                setApiGuides(data.map(g => [g.key, { ...g, icon: Icons[g.icon] || Icons.book }]));
              }
            }
          } catch (error) {
            console.error('Error loading knowledge hub:', error);
          } finally {
            setLoading(false);
          }
        };
        init();
      }, [token, isAdmin]);

      // Search handler with debounce
      const handleSearch = (query) => {
        setSearchQuery(query);
        if (searchTimer.current) clearTimeout(searchTimer.current);
        if (!query || query.trim().length < 2) {
          setSearchResults([]);
          setShowSearchResults(false);
          return;
        }
        searchTimer.current = setTimeout(async () => {
          const results = await searchV2(token, query);
          setSearchResults(results);
          setShowSearchResults(results.length > 0);
        }, 300);
      };

      // Use API guides if available, otherwise fall back to hardcoded
      const visibleGuides = apiGuides.length > 0
        ? apiGuides
        : Object.entries(guides).filter(([key, guide]) => {
            if (guide.ownerOnly) return isOwner;
            if (guide.adminOnly) return isAdmin;
            return true;
          });

      // Redirect to login if not authenticated
      if (!token || !user) {
        window.location.href = '/login';
        return null;
      }

      return (
        <div className="min-h-screen">
          {/* Header */}
          <header className="bg-white/80 backdrop-blur-sm border-b border-gray-100 sticky top-0 z-20">
            <div className="max-w-6xl mx-auto px-6 py-4">
              <div className="flex justify-between items-center">
                <div className="flex items-center gap-4">
                  <img src="/thrive365-logo.webp" alt="Thrive 365 Labs" className="h-10" />
                  <div>
                    <h1 className="text-xl font-bold text-accent">Knowledge Hub</h1>
                    <p className="text-sm text-gray-500 hidden sm:block">Guides and documentation</p>
                  </div>
                </div>
                <div className="flex items-center gap-3">
                  {/* Search Bar */}
                  <div className="relative">
                    <input
                      type="text"
                      value={searchQuery}
                      onChange={(e) => handleSearch(e.target.value)}
                      onFocus={() => searchResults.length > 0 && setShowSearchResults(true)}
                      onBlur={() => setTimeout(() => setShowSearchResults(false), 200)}
                      placeholder="Search guides..."
                      className="search-input w-48 sm:w-64 px-4 py-2 pl-10 border border-gray-200 rounded-lg text-sm bg-gray-50 focus:bg-white focus:border-primary-500 transition"
                    />
                    <svg className="w-4 h-4 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2" fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"/>
                    </svg>
                    {/* Search Dropdown */}
                    {showSearchResults && searchResults.length > 0 && (
                      <div className="absolute top-full mt-1 right-0 w-80 sm:w-96 bg-white rounded-xl shadow-xl border border-gray-200 search-dropdown z-50">
                        <div className="p-3 border-b border-gray-100">
                          <p className="text-xs text-gray-500 font-medium">{searchResults.length} result{searchResults.length !== 1 ? 's' : ''} for "{searchQuery}"</p>
                        </div>
                        <div className="p-2">
                          {searchResults.slice(0, 8).map((result, idx) => (
                            <button
                              key={idx}
                              className="search-item w-full text-left p-3 rounded-lg"
                              onMouseDown={(e) => {
                                e.preventDefault();
                                setSearchQuery('');
                                setShowSearchResults(false);
                                setSearchResults([]);
                                // Find and expand the matching section/article
                                const sectionEl = document.querySelector(`[data-section-key="${result.sectionKey}"]`);
                                if (sectionEl) {
                                  sectionEl.scrollIntoView({ behavior: 'smooth', block: 'center' });
                                  sectionEl.click();
                                }
                              }}
                            >
                              <div className="flex items-center gap-2 mb-1">
                                <span className={`inline-block w-2 h-2 rounded-full ${result.sectionColor || 'bg-gray-400'}`}></span>
                                <span className="text-xs text-gray-500 font-medium">{result.sectionTitle}</span>
                              </div>
                              <p className="text-sm font-medium text-gray-800">{result.featureTitle}</p>
                              {result.snippet && (
                                <p className="text-xs text-gray-500 mt-1 line-clamp-2">{result.snippet.substring(0, 120)}...</p>
                              )}
                            </button>
                          ))}
                        </div>
                      </div>
                    )}
                  </div>
                  <a href="/login" className="flex items-center gap-2 px-4 py-2 text-gray-600 hover:text-primary-600 hover:bg-primary-50 rounded-lg transition">
                    {Icons.back}
                    <span className="hidden sm:inline">Back to Hub</span>
                  </a>
                </div>
              </div>
            </div>
          </header>

          {/* Main Content */}
          <main className="max-w-6xl mx-auto px-4 py-8">
            {/* Banner */}
            <div className="relative rounded-2xl overflow-hidden shadow-lg mb-10" style={{minHeight: '160px', backgroundColor: '#4338ca'}}>
              <div className="absolute inset-0 bg-gradient-to-r from-indigo-700/90 via-indigo-600/70 to-purple-600/50"></div>
              <div className="relative p-8 flex items-center min-h-[160px]">
                <div className="text-white flex items-center gap-4">
                  <div className="p-3 bg-white/20 rounded-xl">
                    {Icons.book}
                  </div>
                  <div>
                    <h2 className="text-3xl font-bold drop-shadow-sm">Knowledge Hub</h2>
                    <p className="text-white/70 mt-1 text-sm">Find guides, tutorials, and documentation for every portal</p>
                  </div>
                </div>
              </div>
            </div>

            {/* Quick Links Section */}
            <div className="bg-white rounded-xl shadow-sm border border-gray-100 p-6 mb-8">
              <h3 className="text-lg font-bold text-accent mb-4 flex items-center gap-2">
                {Icons.link}
                Quick Links
              </h3>
              <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                <a href="/directory" className="flex items-center gap-3 p-4 bg-gray-50 rounded-lg hover:bg-primary-50 hover:border-primary-200 border border-gray-200 transition group">
                  <div className="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600 group-hover:bg-primary-100 group-hover:text-primary-600">
                    {Icons.link}
                  </div>
                  <div>
                    <p className="font-medium text-gray-800">Link Directory</p>
                    <p className="text-xs text-gray-500">All portal URLs</p>
                  </div>
                  <span className="ml-auto text-gray-400">{Icons.external}</span>
                </a>
                <a href="/changelog" className="flex items-center gap-3 p-4 bg-gray-50 rounded-lg hover:bg-primary-50 hover:border-primary-200 border border-gray-200 transition group">
                  <div className="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center text-green-600 group-hover:bg-primary-100 group-hover:text-primary-600">
                    <svg className="w-5 h-5" fill="none" stroke="currentColor" strokeWidth="1.5" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"/></svg>
                  </div>
                  <div>
                    <p className="font-medium text-gray-800">App Changelog</p>
                    <p className="text-xs text-gray-500">Version history</p>
                  </div>
                  <span className="ml-auto text-gray-400">{Icons.external}</span>
                </a>
                <a href="/admin" className="flex items-center gap-3 p-4 bg-gray-50 rounded-lg hover:bg-primary-50 hover:border-primary-200 border border-gray-200 transition group">
                  <div className="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center text-purple-600 group-hover:bg-primary-100 group-hover:text-primary-600">
                    {Icons.admin}
                  </div>
                  <div>
                    <p className="font-medium text-gray-800">Admin Hub</p>
                    <p className="text-xs text-gray-500">User management</p>
                  </div>
                  <span className="ml-auto text-gray-400">{Icons.external}</span>
                </a>
                <a href="/service-portal" className="flex items-center gap-3 p-4 bg-gray-50 rounded-lg hover:bg-primary-50 hover:border-primary-200 border border-gray-200 transition group">
                  <div className="w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center text-emerald-600 group-hover:bg-primary-100 group-hover:text-primary-600">
                    {Icons.service}
                  </div>
                  <div>
                    <p className="font-medium text-gray-800">Service Portal</p>
                    <p className="text-xs text-gray-500">Service reports</p>
                  </div>
                  <span className="ml-auto text-gray-400">{Icons.external}</span>
                </a>
              </div>
            </div>

            {/* Section Overview Grid */}
            <div className="mb-10">
              <h3 className="text-xl font-bold text-accent mb-4">Browse by Topic</h3>
              <div className="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-3">
                {visibleGuides.map(([key, guide]) => (
                  <button
                    key={key}
                    onClick={() => {
                      const el = document.querySelector(`[data-section-key="${key}"]`);
                      if (el) {
                        el.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        // Auto-expand the section
                        const btn = el.querySelector('button');
                        if (btn && !el.querySelector('.guide-content.open')) btn.click();
                      }
                    }}
                    className="section-tile flex flex-col items-center gap-2 p-4 bg-white rounded-xl border border-gray-100 shadow-sm text-center"
                  >
                    <div className={`inline-flex items-center justify-center w-10 h-10 ${guide.color} text-white rounded-lg`}>
                      {React.cloneElement(guide.icon, { className: 'w-5 h-5' })}
                    </div>
                    <span className="text-xs font-medium text-gray-700 leading-tight">{guide.title}</span>
                    <span className="text-xs text-gray-400">{guide.articles?.length || 0} articles</span>
                  </button>
                ))}
              </div>
            </div>

            {/* Guide Categories */}
            <h3 className="text-xl font-bold text-accent mb-6">How-To Guides</h3>

            {visibleGuides.map(([key, guide], idx) => (
              <GuideSection key={key} guide={guide} isAdmin={isAdmin} sectionKey={key} />
            ))}

            {/* Quick Tips Section */}
            <div className="mt-10">
              <h3 className="text-xl font-bold text-accent mb-6">Quick Tips</h3>
              <div className="bg-white rounded-xl shadow-sm border border-gray-100 p-6">
                <ul className="space-y-3 text-gray-600">
                  <li className="flex items-start gap-3">
                    <span className="inline-flex items-center justify-center w-6 h-6 bg-primary-100 text-primary-600 rounded-full text-sm font-bold flex-shrink-0">1</span>
                    <span>Use the <strong>Portal Hub</strong> as your central navigation point - bookmark it for quick access each morning.</span>
                  </li>
                  <li className="flex items-start gap-3">
                    <span className="inline-flex items-center justify-center w-6 h-6 bg-primary-100 text-primary-600 rounded-full text-sm font-bold flex-shrink-0">2</span>
                    <span><strong>Service reports</strong> should be submitted within 24 hours of completing a service visit - use the draft feature to save progress.</span>
                  </li>
                  <li className="flex items-start gap-3">
                    <span className="inline-flex items-center justify-center w-6 h-6 bg-primary-100 text-primary-600 rounded-full text-sm font-bold flex-shrink-0">3</span>
                    <span>Update <strong>project task status</strong> daily to keep implementation teams and clients in sync with progress.</span>
                  </li>
                  <li className="flex items-start gap-3">
                    <span className="inline-flex items-center justify-center w-6 h-6 bg-primary-100 text-primary-600 rounded-full text-sm font-bold flex-shrink-0">4</span>
                    <span>Keep multiple <strong>browser tabs</strong> open for different portals - the system supports simultaneous access across services.</span>
                  </li>
                  <li className="flex items-start gap-3">
                    <span className="inline-flex items-center justify-center w-6 h-6 bg-primary-100 text-primary-600 rounded-full text-sm font-bold flex-shrink-0">5</span>
                    <span>Data syncs with <strong>HubSpot automatically</strong> - changes to projects, tasks, and reports update CRM records in real-time.</span>
                  </li>
                  <li className="flex items-start gap-3">
                    <span className="inline-flex items-center justify-center w-6 h-6 bg-primary-100 text-primary-600 rounded-full text-sm font-bold flex-shrink-0">6</span>
                    <span>Report <strong>bugs or issues</strong> immediately using Admin Hub → Bug Reports so technical issues can be addressed promptly.</span>
                  </li>
                </ul>
              </div>
            </div>

            {/* Need Help Section */}
            <div className="mt-10 bg-gradient-to-r from-primary-500 to-primary-700 rounded-2xl p-8 text-white">
              <h3 className="text-2xl font-bold mb-3">Need Additional Help?</h3>
              <p className="text-white/80 mb-6">Can't find what you're looking for? Our support team is here to help.</p>
              <div className="flex flex-wrap gap-4">
                <a href="mailto:support@thrive365labs.live" className="bg-white text-primary-600 px-6 py-3 rounded-lg font-semibold hover:bg-gray-100 transition">
                  Email Support
                </a>
                <a href="/login" className="bg-white/20 text-white px-6 py-3 rounded-lg font-semibold hover:bg-white/30 transition">
                  Back to Portal Hub
                </a>
              </div>
            </div>
          </main>

          {/* Footer */}
          <footer className="mt-12 py-6 border-t border-gray-200 bg-white/50">
            <div className="max-w-6xl mx-auto px-4 text-center text-sm text-gray-500">
              &copy; 2026 Thrive 365 Labs. All rights reserved.
            </div>
          </footer>
        </div>
      );
    };

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
