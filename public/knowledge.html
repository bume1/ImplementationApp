<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Knowledge Hub - Thrive 365 Labs</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: { 50: '#E6F0F7', 100: '#CCE1EF', 500: '#045E9F', 600: '#034D82', 700: '#033C66', 800: '#022B49' },
            accent: '#1B2D4F',
            success: { 50: '#E6F7F1', 500: '#10B981', 600: '#059669' },
            warning: { 50: '#FEF9E7', 500: '#F59E0B', 600: '#D97706' }
          }
        }
      }
    };
  </script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    body { font-family: system-ui, -apple-system, sans-serif; background: linear-gradient(135deg, #f5f7fa 0%, #e4e8ec 100%); }
    .card-hover { transition: all 0.3s ease; }
    .card-hover:hover { transform: translateY(-4px); box-shadow: 0 12px 24px rgba(0,0,0,0.1); }
    .guide-content { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; }
    .guide-content.open { max-height: 2000px; transition: max-height 0.5s ease-in; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect } = React;

    // Icons
    const Icons = {
      back: <svg className="w-5 h-5" fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"/></svg>,
      book: <svg className="w-8 h-8" fill="none" stroke="currentColor" strokeWidth="1.5" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25"/></svg>,
      admin: <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="1.5" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z"/><path strokeLinecap="round" strokeLinejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/></svg>,
      launch: <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="1.5" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M15.59 14.37a6 6 0 01-5.84 7.38v-4.8m5.84-2.58a14.98 14.98 0 006.16-12.12A14.98 14.98 0 009.631 8.41m5.96 5.96a14.926 14.926 0 01-5.841 2.58m-.119-8.54a6 6 0 00-7.381 5.84h4.8m2.581-5.84a14.927 14.927 0 00-2.58 5.84m2.699 2.7c-.103.021-.207.041-.311.06a15.09 15.09 0 01-2.448-2.448 14.9 14.9 0 01.06-.312m-2.24 2.39a4.493 4.493 0 00-1.757 4.306 4.493 4.493 0 004.306-1.758M16.5 9a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z"/></svg>,
      service: <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="1.5" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M11.42 15.17L17.25 21A2.652 2.652 0 0021 17.25l-5.877-5.877M11.42 15.17l2.496-3.03c.317-.384.74-.626 1.208-.766M11.42 15.17l-4.655 5.653a2.548 2.548 0 11-3.586-3.586l6.837-5.63m5.108-.233c.55-.164 1.163-.188 1.743-.14a4.5 4.5 0 004.486-6.336l-3.276 3.277a3.004 3.004 0 01-2.25-2.25l3.276-3.276a4.5 4.5 0 00-6.336 4.486c.091 1.076-.071 2.264-.904 2.95l-.102.085m-1.745 1.437L5.909 7.5H4.5L2.25 3.75l1.5-1.5L7.5 4.5v1.409l4.26 4.26m-1.745 1.437l1.745-1.437m6.615 8.206L15.75 15.75M4.867 19.125h.008v.008h-.008v-.008z"/></svg>,
      client: <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="1.5" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z"/></svg>,
      hub: <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="1.5" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"/></svg>,
      chevronDown: <svg className="w-5 h-5" fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M19 9l-7 7-7-7"/></svg>,
      chevronRight: <svg className="w-5 h-5" fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M9 5l7 7-7 7"/></svg>,
      link: <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="1.5" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"/></svg>,
      inventory: <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="1.5" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/></svg>,
      support: <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="1.5" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/></svg>,
      files: <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="1.5" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/></svg>,
      users: <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="1.5" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z"/></svg>,
      milestone: <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="1.5" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>,
      external: <svg className="w-4 h-4" fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/></svg>,
      code: <svg className="w-6 h-6" fill="none" stroke="currentColor" strokeWidth="1.5" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M17.25 6.75L22.5 12l-5.25 5.25m-10.5 0L1.5 12l5.25-5.25m7.5-3l-4.5 16.5"/></svg>,
      lock: <svg className="w-4 h-4" fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M16.5 10.5V6.75a4.5 4.5 0 10-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 002.25-2.25v-6.75a2.25 2.25 0 00-2.25-2.25H6.75a2.25 2.25 0 00-2.25 2.25v6.75a2.25 2.25 0 002.25 2.25z"/></svg>
    };

    // Comprehensive Guide Data
    const guides = {
      'portal-hub': {
        title: 'Portal Hub',
        description: 'Your central navigation point for all Thrive 365 Labs services',
        icon: Icons.hub,
        color: 'bg-primary-500',
        articles: [
          {
            title: 'Getting Started with Portal Hub',
            content: `Portal Hub is your central dashboard after logging in. It displays all the portals and services you have access to based on your role and permissions.

**What You'll See:**
- Admin Hub (if you have admin access)
- Launch App (for tracking implementations)
- Service Portal (for field service engineers and CAS)
- Client Portal Admin (for managing client portals)
- Knowledge Hub (you're here!)

**How to Navigate:**
1. Click on any portal card to access that service
2. Each card shows a brief description of what it does
3. Your available portals depend on your assigned permissions

**Sign Out:** Click the "Sign Out" button in the top right corner when you're done.`
          },
          {
            title: 'Understanding Your Permissions',
            content: `Your access to different portals is controlled by permission flags set by an administrator.

**Permission Types:**
- **Admin Hub Access**: View dashboard stats, manage users, handle inbox items
- **Implementations Access**: Track and manage client launch projects
- **Service Portal Access**: Submit service reports and validation reports
- **Client Portal Admin**: Manage client portal settings, announcements, and documents

**Need Different Access?**
Contact your administrator to request additional permissions. They can update your access from the Admin Hub user management section.`
          }
        ]
      },
      'admin-hub': {
        title: 'Admin Hub',
        description: 'User management, permissions, and administration',
        icon: Icons.admin,
        color: 'bg-blue-600',
        articles: [
          {
            title: 'Admin Dashboard Overview',
            content: `The Admin Hub dashboard provides a quick overview of your system status.

**Quick Stats Section:**
- **New Launches**: Shows count of active implementation projects
- **Open Tickets**: Shows pending feedback, bug reports, and password reset requests

**Inbox:**
Access the inbox to view and manage:
- Bug reports from users
- Feature requests
- Password reset requests

**Quick Actions:**
- Navigate to user management
- View system statistics
- Access the changelog`
          },
          {
            title: 'Managing Users',
            content: `User management allows you to create, edit, and manage all system users.

**Creating a New User:**
1. Click "Add User" button
2. Fill in required fields: Name, Email, Password
3. Select the user's Role (Admin, Team Member, Client, Vendor)
4. Assign permissions using the toggle switches
5. For client users, assign their client/practice
6. Click "Save" to create the user

**User Roles:**
- **Admin**: Full system access
- **Team Member**: Internal staff with configurable permissions
- **Client**: Client portal users tied to a specific practice
- **Vendor**: External service providers with limited, client-specific access

**Permission Toggles:**
- Has Admin Hub Access
- Has Implementations Access
- Has Service Portal Access
- Has Client Portal Admin Access

**Bulk Password Reset:**
Select multiple users and click "Reset Passwords" to send password reset emails. Users will be prompted to change their password on first login.`
          },
          {
            title: 'Handling Inbox Items',
            content: `The Admin Inbox collects various requests that need administrator attention.

**Types of Inbox Items:**
1. **Bug Reports**: Issues reported by users through the feedback form
2. **Feature Requests**: Suggestions for new functionality
3. **Password Reset Requests**: Users who forgot their passwords

**Processing Items:**
- Click on an item to view details
- Mark items as resolved once addressed
- Delete items that are no longer needed

**Best Practices:**
- Check the inbox daily
- Respond to password reset requests promptly
- Track recurring bug reports for patterns`
          }
        ]
      },
      'launch-app': {
        title: 'Launch App',
        description: 'Project tracking, client onboarding, and implementations',
        icon: Icons.launch,
        color: 'bg-purple-600',
        articles: [
          {
            title: 'Project Board Overview',
            content: `The Launch App helps you track client implementation projects through their lifecycle.

**Views Available:**
- **Board View**: Kanban-style board with projects organized by status
- **List View**: Traditional list format with all project details

**Project Statuses:**
- New/Pending
- In Progress
- On Hold
- Complete

**Project Cards Show:**
- Client name
- Current phase
- Assigned team members
- Project progress percentage`
          },
          {
            title: 'Managing Projects',
            content: `Each project follows a phase-based approach for structured implementations.

**Creating a Project:**
1. Click "New Project"
2. Enter client details
3. Select the implementation template (e.g., Biolis AU480 CLIA)
4. Assign team members
5. Set target dates

**Project Phases:**
Projects typically follow these phases:
1. **Planning**: Initial setup, contracts, scheduling
2. **Installation**: Equipment delivery and setup
3. **Validation**: Testing and verification
4. **Training**: Staff training and competency
5. **Go-Live**: Final launch and handoff

**Updating Progress:**
- Click on a project to view/edit details
- Check off completed tasks
- Add notes and documentation
- Upload relevant files`
          },
          {
            title: 'Client Milestones View',
            content: `Clients with active projects can view their Launch Milestones from their portal.

**What Clients See:**
- Current project phase
- Completed milestones
- Upcoming tasks
- Overall progress percentage

**Note:** The milestones view only appears for clients with active (non-complete) projects.`
          }
        ]
      },
      'service-portal': {
        title: 'Service Portal',
        description: 'Service reports, field operations, and vendor management',
        icon: Icons.service,
        color: 'bg-emerald-600',
        articles: [
          {
            title: 'Service Portal Overview',
            content: `The Service Portal is designed for Field Service Engineers (FSE) and Clinical Application Specialists (CAS) to document their service activities.

**Main Features:**
- Submit service reports
- Submit validation reports
- View report history
- Track HubSpot ticket integration

**Report Types:**
1. **Service Reports**: Document on-site service calls, repairs, and maintenance
2. **Validation Reports**: Document equipment validation and testing procedures
3. **Training Reports**: Record training sessions and competency assessments`
          },
          {
            title: 'Submitting Service Reports',
            content: `Service reports document all service activities performed at client sites.

**How to Submit a Service Report:**
1. Navigate to Service Portal
2. Click "New Service Report"
3. Select the client from the dropdown
4. Fill in required fields:
   - Service date
   - Service type (Installation, Repair, Maintenance, etc.)
   - Description of work performed
   - Parts used (if any)
5. Add technician signature
6. Get client signature
7. Submit the report

**After Submission:**
- Report is saved to the system
- PDF is generated automatically
- Report syncs to HubSpot (creates ticket, attaches to company/deal)
- Client can view the report in their support tickets

**Saving Drafts:**
Click "Save as Draft" to save your work and complete it later.`
          },
          {
            title: 'Validation Reports',
            content: `Validation reports document equipment validation procedures and results.

**When to Use:**
- Initial equipment validation
- Annual revalidation
- Post-repair validation
- Method validation

**Report Sections:**
1. **General Information**: Client, equipment, validation type
2. **Test Procedures**: Step-by-step validation protocol
3. **Results**: Test outcomes and measurements
4. **Custom Fields**: Configurable fields for specific validation types
5. **Signatures**: Technician and client approval

**Best Practices:**
- Complete all required fields
- Attach supporting documentation
- Ensure both signatures are captured
- Review before final submission`
          },
          {
            title: 'HubSpot Integration',
            content: `Service reports automatically integrate with HubSpot CRM.

**What Gets Created:**
- A new ticket in HubSpot
- PDF attachment of the service report
- Association to the client's company record
- Association to the deal record (if applicable)

**Benefits:**
- Centralized ticket tracking
- Automatic documentation
- Client visibility through Customer Support Center
- Audit trail for all service activities`
          }
        ]
      },
      'client-portal': {
        title: 'Client Portal',
        description: 'Managing client portals, content, and communications',
        icon: Icons.client,
        color: 'bg-amber-500',
        articles: [
          {
            title: 'Client Portal Overview',
            content: `Each client has their own dedicated portal accessible at /portal/{client-slug}.

**Client Portal Features:**
- Home Dashboard with announcements
- Launch Milestones (if project is active)
- Inventory Management
- Customer Support Center
- Files & Documents

**Client Navigation:**
Clients use the sidebar to navigate between sections. The sidebar shows only features relevant to their account.`
          },
          {
            title: 'Managing Announcements',
            content: `Announcements appear on the client's home dashboard.

**Creating Announcements:**
1. Go to Client Portal Admin > Announcements
2. Click "New Announcement"
3. Fill in:
   - Title
   - Content
   - Type (Info, Warning, Success)
4. Optional: Mark as Pinned (stays at top)
5. Optional: Mark as Priority (highlighted)
6. Optional: Attach a file

**Announcement Types:**
- **Info** (Blue): General information
- **Warning** (Yellow): Important notices
- **Success** (Green): Positive updates

**Managing Announcements:**
- Edit existing announcements
- Delete outdated announcements
- Pin important announcements to the top`
          },
          {
            title: 'Managing Client Documents',
            content: `Upload and organize documents for clients to access.

**Uploading Documents:**
1. Go to Client Portal Admin > Documents
2. Click "Upload Document"
3. Select the file
4. Choose a category:
   - Contracts
   - Onboarding
   - Inserts
   - Certificates of Analysis
   - Analyzer
   - Other
5. Add optional notes
6. Upload

**Document Organization:**
Documents are grouped by category for easy navigation. Clients can download any document you've uploaded.

**Client Uploads:**
Clients can also upload documents from their Files page. These appear in a separate "Client Uploads" section for admin review.`
          },
          {
            title: 'Portal Settings',
            content: `Configure client-specific portal settings.

**Available Settings:**
- Practice name display
- Logo customization
- Banner image
- Contact information

**Customizing Appearance:**
1. Go to Portal Settings
2. Upload a client logo
3. Set a custom banner image
4. Save changes

Customizations appear throughout the client's portal experience.`
          }
        ]
      },
      'inventory': {
        title: 'Inventory Management',
        description: 'Weekly inventory updates, reports, and alerts',
        icon: Icons.inventory,
        color: 'bg-teal-600',
        articles: [
          {
            title: 'Weekly Inventory Updates',
            content: `Clients submit weekly inventory counts to track stock levels.

**How to Submit:**
1. Navigate to Inventory > Weekly Update
2. Review the item list
3. Enter current quantities:
   - Open Qty: Items currently opened/in use
   - Closed Qty: Items still sealed
4. Add expiration dates if applicable
5. Click "Submit Inventory"

**Submission Reminder:**
A warning banner appears if you haven't submitted inventory in the past 7 days. Keep submissions current for accurate tracking.`
          },
          {
            title: 'Understanding Inventory Reports',
            content: `The Reports & Alerts page shows your current inventory status.

**Low Stock Alerts (Red):**
Items with a combined quantity (open + closed) of 2 or fewer units. These require immediate attention to prevent stockouts.
- **Action**: Reorder these items as soon as possible

**Expiring Soon (Orange):**
Items with expiration dates within the next 30 days.
- **Action**: Prioritize using expiring items; plan replacement orders

**Current Stock Levels (Blue):**
Shows all items currently in stock based on your most recent submission.
- Filter by category to find specific item types
- Search to quickly locate items
- See breakdown of open vs closed quantities

**Download CSV:**
Export your inventory data for external analysis or records.`
          },
          {
            title: 'Submission History',
            content: `View all past inventory submissions.

**What's Shown:**
- Submission date and time
- Item counts
- Submitter name (if applicable)

**Using History:**
- Track inventory trends over time
- Reference past counts
- Identify submission patterns

**Filtering:**
Use the search and filter options to find specific submissions.`
          }
        ]
      },
      'customer-support': {
        title: 'Customer Support Center',
        description: 'Tickets, live chat, and support resources',
        icon: Icons.support,
        color: 'bg-sky-600',
        articles: [
          {
            title: 'Support Center Overview',
            content: `The Customer Support Center provides multiple ways to get help.

**Three Support Options:**
1. **Ticket History**: View your past and current support tickets
2. **Submit a Ticket**: Create a new support request
3. **Live Chat**: Chat with support agents in real time

**Accessing Support:**
Navigate to Customer Support from the sidebar menu.`
          },
          {
            title: 'Viewing Ticket History',
            content: `See all your support tickets in one place.

**Ticket Information:**
- Subject/title
- Creation date
- Current status
- Resolution notes (when resolved)

**Ticket Statuses:**
- **New**: Just submitted
- **In Progress**: Being worked on
- **Assigned**: Assigned to a specific agent
- **Vendor Escalation**: Escalated to vendor support
- **Resolved**: Issue resolved
- **Closed**: Ticket closed

**Viewing Details:**
Click on any ticket to expand and see:
- Full description
- Resolution notes
- Attached files (including service reports)

**Attachments:**
Service reports submitted by technicians appear as downloadable attachments on related tickets.`
          },
          {
            title: 'Submitting a Ticket',
            content: `Create a new support request for any issues or questions.

**How to Submit:**
1. Click the "Submit a Ticket" tab
2. Fill out the support form with:
   - Subject
   - Description of your issue
   - Priority level
   - Any relevant attachments
3. Submit the form

**Response Time:**
Expect a response within 24-48 hours for standard requests.

**Alternative Contact:**
You can also email support directly at support@thrive365labs.com`
          },
          {
            title: 'Using Live Chat',
            content: `Get real-time help from support agents.

**Starting a Chat:**
1. Click the "Live Chat" tab
2. Click "Start Chat Now" button
3. Or use the chat icon in the bottom-right corner

**Chat Availability:**
Support agents are available during business hours. The green indicator shows when agents are online.

**Best For:**
- Quick questions
- Urgent issues
- Real-time troubleshooting`
          }
        ]
      },
      'files': {
        title: 'Files & Documents',
        description: 'Document management and file uploads',
        icon: Icons.files,
        color: 'bg-violet-600',
        articles: [
          {
            title: 'Accessing Documents',
            content: `The Files page shows all documents shared with you.

**Document Categories:**
- Contracts
- Onboarding
- Inserts
- Certificates of Analysis
- Analyzer
- Other

**Downloading Files:**
Click on any document to download it to your device.`
          },
          {
            title: 'Uploading Documents',
            content: `Clients can upload documents for admin review.

**How to Upload:**
1. Navigate to Files
2. Click "Upload File"
3. Select your file
4. Choose a category
5. Add optional notes
6. Upload

**Supported Files:**
Most common file types are supported including PDF, Word, Excel, and images.

**Where Files Go:**
Uploaded files appear in the "Your Uploads" section and are also visible to administrators.

**HubSpot Integration:**
If configured, uploaded files are automatically attached to your HubSpot company/deal record.`
          }
        ]
      },
      'technical-docs': {
        title: 'Technical Documentation',
        description: 'System architecture, API reference, and developer resources',
        icon: Icons.code,
        color: 'bg-slate-700',
        ownerOnly: true,
        articles: [
          {
            title: 'System Overview',
            content: `Thrive 365 Labs Web App is a comprehensive multi-project launch tracker designed for managing complex clinical laboratory equipment installations.

**Key Features:**
- 102-task template for Biolis AU480 CLIA lab setups
- Robust admin controls and team member accounts
- Embeddable, authenticated client portals for external stakeholders
- Service Portal for field service engineers and clinical application specialists
- HubSpot CRM integration for seamless deal tracking and file management
- Google Drive integration for document storage

**Technology Stack:**
- Backend: Express.js REST API
- Frontend: React 18 (CDN-loaded), Babel standalone for JSX
- Styling: Tailwind CSS (CDN)
- Database: Replit Database (key-value store)
- Authentication: JWT tokens, bcryptjs password hashing
- PDF Generation: PDFKit, PDFMake

**System Design Principles:**
- Modularity: Clear separation of frontend and backend concerns
- Scalability: CDN-based frontend delivery and flexible key-value data storage
- Security: JWT-based authentication, bcrypt password hashing, role-based access control
- User Experience: Streamlined workflows, intuitive reporting, and client-facing transparency`
          },
          {
            title: 'Application Portals',
            content: `The application consists of multiple interconnected portals, each serving different user roles:

**1. Unified Login Portal (/login)**
Central authentication hub where users log in once and access all portals they have permissions for.

**2. Admin Hub (/admin)**
Administrative dashboard for system management:
- User management with granular permissions
- Dashboard statistics and quick actions
- Feedback/bug report inbox
- Bulk password reset functionality
- Activity logging and system settings

**3. Launch App (/launch/home)**
Project implementation tracking for internal teams:
- Project boards with task management
- 102-task template system
- HubSpot synchronization
- Soft-pilot checklist generation
- Launch reports and analytics
- Implementations calendar

**4. Client Portal (/portal/{slug})**
Authenticated client-facing portal:
- Home dashboard with announcements
- Launch milestones and progress tracking
- Inventory management with weekly updates
- Customer support with HubSpot ticket integration
- Files and documents section

**5. Service Portal (/service-portal)**
Dedicated portal for field service engineers and CAS:
- Service report creation and management
- Validation reports (Phase 3)
- Digital signature capture
- PDF generation and export
- HubSpot ticket auto-creation

**6. Knowledge Hub (/knowledge)**
Resource center with how-to guides, documentation, and link directory.

**7. Changelog (/changelog)**
Version history and release notes for the application.`
          },
          {
            title: 'User Management & Permissions',
            content: `The application uses a role-based access control system with granular permission flags.

**User Roles:**
- Admin: Full system access
- Team Member: Internal staff with configurable permissions
- Client: Client portal users tied to a specific practice
- Vendor: External service providers with limited, client-specific access

**Permission Flags:**
- hasServicePortalAccess: Service Portal access
- hasAdminHubAccess: Admin Hub access
- hasImplementationsAccess: Implementation App access
- hasClientPortalAdminAccess: Client Portal admin features
- assignedClients: Array for vendor client assignments

**Authentication Features:**
- JWT-based authentication with secure token management
- Password reset system with admin approval workflow
- Bulk password reset with first-login change prompt
- Forgot password request system`
          },
          {
            title: 'Project & Task Management',
            content: `The Launch App provides comprehensive project and task management.

**102-Task Biolis AU480 CLIA Template:**
Industry-standard workflow for clinical laboratory equipment installations.

**Task Features:**
- Per-stage task addition
- Email-based owner assignment
- Subtasks with completion enforcement
- Task descriptions and notes
- Due dates with timeline sorting
- Task reordering within stages
- File attachments (PDF, images, Word, Excel, text)
- Tagging system with global tag library
- Bulk operations (update, delete)

**Additional Features:**
- Project cloning for rapid duplication
- CSV import/export for bulk task management
- Template system for reusable project structures
- Project notes log with aggregated view`
          },
          {
            title: 'API Reference - Authentication',
            content: `Authentication API endpoints for user login and management.

**POST /api/auth/login**
User login - returns JWT token and user data

**POST /api/auth/signup**
User registration - creates new user account

**POST /api/auth/client-login**
Client portal login - authenticates client users

**POST /api/auth/service-login**
Service portal login - authenticates service personnel

**POST /api/auth/admin-login**
Admin hub login - authenticates admin users

**POST /api/auth/forgot-password**
Password reset request - sends reset notification to admin

**POST /api/auth/change-password**
Change user password - updates password for authenticated user`
          },
          {
            title: 'API Reference - Projects & Tasks',
            content: `Project and task management API endpoints.

**Projects:**
- GET /api/projects - List all projects
- POST /api/projects - Create new project
- GET /api/projects/:id - Get project details
- PUT /api/projects/:id - Update project
- DELETE /api/projects/:id - Delete project
- POST /api/projects/:id/clone - Clone project
- GET /api/projects/:id/export - Export project data

**Tasks:**
- GET /api/projects/:id/tasks - List project tasks
- POST /api/projects/:id/tasks - Create task
- PUT /api/projects/:projectId/tasks/:taskId - Update task
- DELETE /api/projects/:projectId/tasks/:taskId - Delete task
- POST /api/projects/:projectId/tasks/:taskId/reorder - Reorder task
- PUT /api/projects/:projectId/tasks/bulk-update - Bulk update tasks
- POST /api/projects/:projectId/tasks/bulk-delete - Bulk delete tasks

**Subtasks:**
- POST /api/projects/:projectId/tasks/:taskId/subtasks - Create subtask
- PUT /api/projects/:projectId/tasks/:taskId/subtasks/:subtaskId - Update subtask
- DELETE /api/projects/:projectId/tasks/:taskId/subtasks/:subtaskId - Delete subtask

**Notes & Files:**
- POST /api/projects/:projectId/tasks/:taskId/notes - Add note
- PUT /api/projects/:projectId/tasks/:taskId/notes/:noteId - Update note
- DELETE /api/projects/:projectId/tasks/:taskId/notes/:noteId - Delete note
- POST /api/projects/:projectId/tasks/:taskId/files - Upload file
- DELETE /api/projects/:projectId/tasks/:taskId/files/:fileId - Delete file`
          },
          {
            title: 'API Reference - Users & Templates',
            content: `User management and template API endpoints.

**User Management (Admin):**
- GET /api/users - List all users
- POST /api/users - Create user
- PUT /api/users/:userId - Update user
- DELETE /api/users/:userId - Delete user
- GET /api/team-members - List team members
- POST /api/admin/bulk-password-reset - Bulk password reset

**Templates:**
- GET /api/templates - List templates
- POST /api/templates - Create template
- GET /api/templates/:id - Get template
- PUT /api/templates/:id - Update template
- DELETE /api/templates/:id - Delete template
- POST /api/templates/:id/clone - Clone template
- POST /api/templates/:id/import-csv - Import CSV to template
- PUT /api/templates/:id/set-default - Set as default template`
          },
          {
            title: 'API Reference - Inventory & Service Portal',
            content: `Inventory management and service portal API endpoints.

**Inventory:**
- GET /api/inventory/template - Get inventory template
- PUT /api/inventory/template - Update inventory template
- GET /api/inventory/submissions/:slug - Get submissions history
- GET /api/inventory/latest/:slug - Get latest submission
- POST /api/inventory/submit - Submit inventory update
- GET /api/inventory/report/:slug - Get inventory report
- GET /api/inventory/export/:slug - Export inventory CSV
- GET /api/inventory/custom-items/:slug - Get custom items
- POST /api/inventory/custom-items/:slug - Add custom item
- DELETE /api/inventory/custom-items/:slug/:itemId - Delete custom item

**Service Portal:**
- GET /api/service-portal/data - Get portal data
- GET /api/service-portal/clients - Get assigned clients
- POST /api/service-reports - Create service report
- GET /api/service-reports - List service reports
- GET /api/service-reports/:id - Get service report
- PUT /api/service-reports/:id - Update service report
- DELETE /api/service-reports/:id - Delete service report
- POST /api/validation-reports - Create validation report
- GET /api/validation-reports - List validation reports
- GET /api/validation-reports/:id - Get validation report
- PUT /api/validation-reports/:id - Update validation report`
          },
          {
            title: 'API Reference - HubSpot Integration',
            content: `HubSpot CRM integration API endpoints.

**HubSpot Endpoints:**
- GET /api/hubspot/test - Test HubSpot connection
- GET /api/hubspot/pipelines - Get deal pipelines
- GET /api/hubspot/deals - Get deals
- GET /api/hubspot/record/:recordId - Get HubSpot record
- GET /api/hubspot/stage-mapping - Get stage mapping
- PUT /api/hubspot/stage-mapping - Update stage mapping
- POST /api/hubspot/upload-to-deal - Upload file to deal
- POST /api/projects/:id/hubspot-sync - Sync project to HubSpot
- POST /api/projects/:id/soft-pilot-checklist - Generate soft-pilot checklist

**Integration Features:**
- OAuth-based configuration for secure authentication
- Deal pipeline sync with stage mapping
- Task completion notes sync
- Stage progression tracking
- File uploads to Company, Deal, Contact records
- HubSpot ticket integration for customer support
- Chatbot embed for live chat support
- Webhook endpoint for form submissions
- Idempotent sync with stored HubSpot IDs to prevent duplicates`
          },
          {
            title: 'External Dependencies & Environment',
            content: `Third-party services and configuration requirements.

**Third-Party Services:**
- HubSpot: CRM integration for deal pipeline, client profiles, ticket management, and file storage
- Google Drive: Storage for soft-pilot checklist uploads and document management
- Replit Database: Primary data persistence (key-value store)

**NPM Packages:**
- @hubspot/api-client: ^13.4.0
- @replit/database: ^2.0.5
- axios: ^1.13.2
- bcryptjs: ^2.4.3
- body-parser: ^1.20.2
- cors: ^2.8.5
- express: ^4.18.2
- form-data: ^4.0.5
- googleapis: ^169.0.0
- jsonwebtoken: ^9.0.2
- multer: ^2.0.2
- pdfkit: ^0.17.2
- pdfmake: ^0.3.3
- uuid: ^9.0.0

**CDN Dependencies (Frontend):**
- React 18 / ReactDOM 18
- Babel standalone (JSX transpilation)
- Tailwind CSS
- Heroicons v2

**Environment Variables:**
- PORT: Server port (default: 3000) - Optional
- JWT_SECRET: Secret key for JWT token signing - Required
- HUBSPOT_WEBHOOK_SECRET: Secret for HubSpot webhook validation - Optional
- HUBSPOT_PRIVATE_APP_TOKEN: HubSpot private app token for API access - Required
- GOOGLE_SERVICE_ACCOUNT_KEY: Google service account credentials (JSON) - Optional`
          },
          {
            title: 'Project Structure',
            content: `File organization and directory structure.

**Root Directory:**
- server.js: Main Express server with API routes
- hubspot.js: HubSpot integration module
- googledrive.js: Google Drive integration module
- pdf-generator.js: PDF generation utilities
- changelog-generator.js: Automated changelog generation
- package.json: Dependencies and scripts
- template-biolis-au480-clia.json: Default task template

**Public Directory (/public):**
- index.html: Root HTML
- login.html: Unified login portal
- admin-hub.html: Admin dashboard
- app.js: Main React application
- portal.html: Client portal
- service-portal.html: Service portal
- client.html: Legacy client view
- knowledge.html: Knowledge hub
- link-directory.html: Resource links
- changelog.html: Version history viewer
- changelog.md: Markdown changelog

**Static Assets:**
- attached_assets/: Static assets directory
- banners/: Banner images
- thrive365-logo.webp: Logo file

**Deployment:**
1. Import the project to Replit
2. Configure environment secrets in Replit Secrets
3. Click "Run" to start the application
4. Configure custom domain if needed

The application supports custom domains for main application access and client portal URLs (e.g., launch.yourdomain.com/{slug}).`
          }
        ]
      },
      'admin-guide': {
        title: 'Admin Guide',
        description: 'Key tips, best practices, and advanced features for system administrators',
        icon: Icons.admin,
        color: 'bg-rose-600',
        adminOnly: true,
        articles: [
          {
            title: 'Admin Hub Best Practices',
            content: `Essential tips for effectively managing the Admin Hub.

**Dashboard Overview:**
The Admin Hub dashboard is your command center. Use the quick stats section to monitor:
- Active implementation projects (New Launches count)
- Pending items requiring attention (Open Tickets)

**Inbox Management Tips:**
1. Check the inbox at least once daily
2. Prioritize password reset requests - users are blocked until resolved
3. Track bug reports for patterns that may indicate system issues
4. Use feature requests to inform development priorities

**Quick Actions:**
- Navigate directly to User Management from the dashboard
- Access system statistics for a high-level overview
- View the changelog to stay informed about updates

**Best Practice:** Set a daily routine to review the inbox first thing in the morning.`
          },
          {
            title: 'User Management Deep Dive',
            content: `Advanced user management techniques and strategies.

**User Role Selection Guide:**
- **Admin**: Reserve for system owners and IT administrators only
- **Team Member**: Most internal staff - use permission toggles for fine-grained control
- **Client**: Always assign to a specific practice/client
- **Vendor**: External service providers - limit to assigned clients only

**Permission Strategy:**
Think about least-privilege access:
1. Start with minimal permissions
2. Add access as needed based on job function
3. Review permissions quarterly

**Manager Flag:**
The "Is Manager" toggle gives limited Admin Hub access without full admin privileges. Use for:
- Team leads who need to view dashboard stats
- Supervisors who need to manage service portal

**Bulk Operations Tips:**
1. Use search to filter users first
2. Select multiple users with checkboxes
3. Bulk password reset sends emails with temporary passwords
4. Users will be prompted to change password on first login

**Security Tip:** Always verify email addresses before creating accounts to prevent unauthorized access.`
          },
          {
            title: 'Reporting & Analytics',
            content: `Understanding and using reports effectively across the system.

**Admin Hub Dashboard Stats:**
- **New Launches**: Count of active (non-complete) implementation projects
- **Open Tickets**: Sum of unresolved feedback, bugs, and password reset requests

**Service Portal Reports:**
Service reports are automatically synced to HubSpot:
1. PDF generated on submission
2. Ticket created in HubSpot
3. Attached to client's company record
4. Visible in client's Customer Support Center

**Launch App Reports:**
From the Launch App, you can:
- Export soft-pilot checklists to Google Drive
- Generate project status reports
- View task completion analytics

**Inventory Reports (Client Portal):**
Monitor client inventory through:
- Low stock alerts (2 or fewer items)
- Expiring soon warnings (30 days)
- Weekly submission compliance
- CSV export for external analysis

**Pro Tip:** Set up regular report reviews (weekly for inventory, monthly for projects) to catch issues early.`
          },
          {
            title: 'HubSpot Integration Management',
            content: `Managing the HubSpot CRM integration effectively.

**What Syncs Automatically:**
1. Service reports create HubSpot tickets
2. Files uploaded sync to company/deal records
3. Support tickets from portal appear in HubSpot
4. Deal pipeline stages can be mapped to project stages

**Troubleshooting Sync Issues:**
- Check the HUBSPOT_PRIVATE_APP_TOKEN is valid
- Verify the HubSpot company/deal record exists
- Review server logs for API errors
- Test connection using /api/hubspot/test endpoint

**Best Practices:**
1. Keep HubSpot company records up to date
2. Use consistent naming conventions
3. Map project stages to deal stages for accurate pipeline views
4. Review sync status after major updates

**Important:** Changes made directly in HubSpot may not reflect in the portal. Always make primary changes in the portal.`
          },
          {
            title: 'Troubleshooting Common Issues',
            content: `Quick solutions for frequently encountered problems.

**User Can't Login:**
1. Verify email is correct (case-sensitive)
2. Check if password reset is needed
3. Confirm user account exists and is active
4. Clear browser cache/cookies

**Service Portal Issues:**
1. Ensure user has "Has Service Portal Access" permission
2. Verify they're using the correct login
3. Check if they have assigned clients (for vendors)

**Client Portal Issues:**
1. Confirm client user is assigned to correct practice
2. Verify the practice slug is correct
3. Check if the client portal is enabled

**Inventory Not Showing:**
1. Ensure inventory template exists for the client
2. Verify client has submitted at least one update
3. Check browser console for JavaScript errors

**HubSpot Not Syncing:**
1. Verify HubSpot API token is valid
2. Check server logs for error messages
3. Confirm company/deal record exists in HubSpot
4. Test API connection

**General Tips:**
- Always check browser console (F12) for JavaScript errors
- Clear browser cache when experiencing display issues
- Verify user permissions are correctly assigned
- Check server logs for API errors`
          },
          {
            title: 'Security & Access Control',
            content: `Security best practices for system administrators.

**Password Policies:**
- Minimum 8 characters required
- Encourage mix of letters, numbers, symbols
- Force password change on first login for new users
- Process password reset requests promptly

**Session Management:**
- JWT tokens expire after 24 hours
- Users must re-authenticate after token expiry
- Tokens stored in browser localStorage
- Logout clears all stored tokens

**Permission Auditing:**
Regularly review:
1. Who has Admin access
2. Which vendors have client access
3. Team member permission levels
4. Inactive user accounts

**Security Checklist:**
- [ ] Review admin accounts quarterly
- [ ] Audit vendor access monthly
- [ ] Remove access for departed employees immediately
- [ ] Monitor for unusual login patterns
- [ ] Keep environment variables secure

**Emergency Procedures:**
If you suspect unauthorized access:
1. Change affected user passwords immediately
2. Review recent activity in the system
3. Check HubSpot for unexpected changes
4. Update JWT_SECRET if token compromise suspected
5. Notify affected clients if their data was accessed`
          }
        ]
      }
    };

    // Expandable Guide Section Component
    const GuideSection = ({ guide, isAdmin }) => {
      const [isOpen, setIsOpen] = useState(false);
      const [openArticle, setOpenArticle] = useState(null);

      // Determine border styling based on access level
      const getBorderClass = () => {
        if (guide.ownerOnly) return 'border-amber-200 ring-1 ring-amber-100';
        if (guide.adminOnly) return 'border-rose-200 ring-1 ring-rose-100';
        return 'border-gray-100';
      };

      return (
        <div className={`bg-white rounded-xl shadow-sm border overflow-hidden mb-4 ${getBorderClass()}`}>
          <button
            onClick={() => setIsOpen(!isOpen)}
            className="w-full p-5 flex items-center justify-between hover:bg-gray-50 transition"
          >
            <div className="flex items-center gap-4">
              <div className={`inline-flex items-center justify-center w-12 h-12 ${guide.color} text-white rounded-xl`}>
                {guide.icon}
              </div>
              <div className="text-left">
                <div className="flex items-center gap-2">
                  <h3 className="text-lg font-semibold text-accent">{guide.title}</h3>
                  {guide.ownerOnly && (
                    <span className="inline-flex items-center gap-1 px-2 py-0.5 bg-amber-100 text-amber-700 text-xs font-medium rounded-full">
                      {Icons.lock}
                      Admin Only
                    </span>
                  )}
                  {guide.adminOnly && (
                    <span className="inline-flex items-center gap-1 px-2 py-0.5 bg-rose-100 text-rose-700 text-xs font-medium rounded-full">
                      {Icons.lock}
                      Super Admin
                    </span>
                  )}
                </div>
                <p className="text-gray-500 text-sm">{guide.description}</p>
              </div>
            </div>
            <div className={`text-gray-400 transition-transform ${isOpen ? 'rotate-180' : ''}`}>
              {Icons.chevronDown}
            </div>
          </button>

          <div className={`guide-content ${isOpen ? 'open' : ''}`}>
            <div className="border-t border-gray-100 p-4 bg-gray-50">
              <p className="text-sm text-gray-500 mb-3">{guide.articles.length} article{guide.articles.length !== 1 ? 's' : ''}</p>
              <div className="space-y-2">
                {guide.articles.map((article, idx) => (
                  <div key={idx} className="bg-white rounded-lg border border-gray-200 overflow-hidden">
                    <button
                      onClick={() => setOpenArticle(openArticle === idx ? null : idx)}
                      className="w-full p-4 flex items-center justify-between hover:bg-gray-50 transition text-left"
                    >
                      <span className="font-medium text-gray-800">{article.title}</span>
                      <span className={`text-gray-400 transition-transform ${openArticle === idx ? 'rotate-90' : ''}`}>
                        {Icons.chevronRight}
                      </span>
                    </button>
                    {openArticle === idx && (
                      <div className="px-4 pb-4 border-t border-gray-100 bg-gray-50">
                        <div className="prose prose-sm max-w-none mt-4 text-gray-600 whitespace-pre-wrap">
                          {article.content.split('\n').map((paragraph, pIdx) => {
                            if (paragraph.startsWith('**') && paragraph.endsWith('**')) {
                              return <h4 key={pIdx} className="font-semibold text-gray-800 mt-4 mb-2">{paragraph.replace(/\*\*/g, '')}</h4>;
                            }
                            if (paragraph.startsWith('- ')) {
                              return <li key={pIdx} className="ml-4">{paragraph.substring(2)}</li>;
                            }
                            if (paragraph.match(/^\d+\./)) {
                              return <li key={pIdx} className="ml-4 list-decimal">{paragraph.substring(paragraph.indexOf('.') + 2)}</li>;
                            }
                            if (paragraph.trim() === '') {
                              return <br key={pIdx} />;
                            }
                            return <p key={pIdx} className="mb-2">{paragraph.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>').split('<strong>').map((part, i) => {
                              if (part.includes('</strong>')) {
                                const [bold, rest] = part.split('</strong>');
                                return <span key={i}><strong>{bold}</strong>{rest}</span>;
                              }
                              return part;
                            })}</p>;
                          })}
                        </div>
                      </div>
                    )}
                  </div>
                ))}
              </div>
            </div>
          </div>
        </div>
      );
    };

    const App = () => {
      // Check multiple token sources for authentication
      const [token, setToken] = useState(() => {
        return localStorage.getItem('unified_token') || localStorage.getItem('admin_token') || localStorage.getItem('token');
      });
      const [user, setUser] = useState(() => {
        try {
          const userData = localStorage.getItem('unified_user') || localStorage.getItem('admin_user') || localStorage.getItem('user');
          return userData ? JSON.parse(userData) : null;
        } catch {
          return null;
        }
      });

      // Check if user is admin
      const isAdmin = user?.role === 'admin' || user?.isAdmin === true;

      // Check if user is the system owner (hidden failsafe)
      const isOwner = user?.email?.toLowerCase() === 'bianca@thrive365labs.com';

      // Filter guides based on user permissions
      const visibleGuides = Object.entries(guides).filter(([key, guide]) => {
        // Owner-only sections are restricted to bianca@thrive365labs.com
        if (guide.ownerOnly) {
          return isOwner;
        }
        // Admin-only sections visible to all super admins
        if (guide.adminOnly) {
          return isAdmin;
        }
        return true;
      });

      // Redirect to login if not authenticated
      if (!token || !user) {
        window.location.href = '/login';
        return null;
      }

      return (
        <div className="min-h-screen">
          {/* Header */}
          <header className="bg-white/80 backdrop-blur-sm border-b border-gray-100 sticky top-0 z-10">
            <div className="max-w-6xl mx-auto px-6 py-4 flex justify-between items-center">
              <div className="flex items-center gap-4">
                <img src="/thrive365-logo.webp" alt="Thrive 365 Labs" className="h-10" />
                <div>
                  <h1 className="text-xl font-bold text-accent">Knowledge Hub</h1>
                  <p className="text-sm text-gray-500">Comprehensive guides and documentation for using the Thrive 365 Labs Portal Hub</p>
                </div>
              </div>
              <a href="/login" className="flex items-center gap-2 px-4 py-2 text-gray-600 hover:text-primary-600 hover:bg-primary-50 rounded-lg transition">
                {Icons.back}
                <span className="hidden sm:inline">Back to Hub</span>
              </a>
            </div>
          </header>

          {/* Main Content */}
          <main className="max-w-6xl mx-auto px-4 py-8">
            {/* Banner */}
            <div className="relative rounded-2xl overflow-hidden shadow-lg mb-10" style={{minHeight: '160px', backgroundColor: '#4338ca'}}>
              <div className="absolute inset-0 bg-gradient-to-r from-indigo-700/90 via-indigo-600/70 to-purple-600/50"></div>
              <div className="relative p-8 flex items-center min-h-[160px]">
                <div className="text-white flex items-center gap-4">
                  <div className="p-3 bg-white/20 rounded-xl">
                    {Icons.book}
                  </div>
                  <div>
                    <h2 className="text-3xl font-bold drop-shadow-sm">Knowledge Hub</h2>
                  </div>
                </div>
              </div>
            </div>

            {/* Quick Links Section */}
            <div className="bg-white rounded-xl shadow-sm border border-gray-100 p-6 mb-8">
              <h3 className="text-lg font-bold text-accent mb-4 flex items-center gap-2">
                {Icons.link}
                Quick Links
              </h3>
              <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                <a href="/directory" className="flex items-center gap-3 p-4 bg-gray-50 rounded-lg hover:bg-primary-50 hover:border-primary-200 border border-gray-200 transition group">
                  <div className="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600 group-hover:bg-primary-100 group-hover:text-primary-600">
                    {Icons.link}
                  </div>
                  <div>
                    <p className="font-medium text-gray-800">Link Directory</p>
                    <p className="text-xs text-gray-500">All portal URLs</p>
                  </div>
                  <span className="ml-auto text-gray-400">{Icons.external}</span>
                </a>
                <a href="/changelog" className="flex items-center gap-3 p-4 bg-gray-50 rounded-lg hover:bg-primary-50 hover:border-primary-200 border border-gray-200 transition group">
                  <div className="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center text-green-600 group-hover:bg-primary-100 group-hover:text-primary-600">
                    <svg className="w-5 h-5" fill="none" stroke="currentColor" strokeWidth="1.5" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"/></svg>
                  </div>
                  <div>
                    <p className="font-medium text-gray-800">App Changelog</p>
                    <p className="text-xs text-gray-500">Version history</p>
                  </div>
                  <span className="ml-auto text-gray-400">{Icons.external}</span>
                </a>
                <a href="/admin" className="flex items-center gap-3 p-4 bg-gray-50 rounded-lg hover:bg-primary-50 hover:border-primary-200 border border-gray-200 transition group">
                  <div className="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center text-purple-600 group-hover:bg-primary-100 group-hover:text-primary-600">
                    {Icons.admin}
                  </div>
                  <div>
                    <p className="font-medium text-gray-800">Admin Hub</p>
                    <p className="text-xs text-gray-500">User management</p>
                  </div>
                  <span className="ml-auto text-gray-400">{Icons.external}</span>
                </a>
                <a href="/service-portal" className="flex items-center gap-3 p-4 bg-gray-50 rounded-lg hover:bg-primary-50 hover:border-primary-200 border border-gray-200 transition group">
                  <div className="w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center text-emerald-600 group-hover:bg-primary-100 group-hover:text-primary-600">
                    {Icons.service}
                  </div>
                  <div>
                    <p className="font-medium text-gray-800">Service Portal</p>
                    <p className="text-xs text-gray-500">Service reports</p>
                  </div>
                  <span className="ml-auto text-gray-400">{Icons.external}</span>
                </a>
              </div>
            </div>

            {/* Guide Categories */}
            <h3 className="text-xl font-bold text-accent mb-6">How-To Guides</h3>

            {visibleGuides.map(([key, guide], idx) => (
              <GuideSection key={key} guide={guide} isAdmin={isAdmin} />
            ))}

            {/* Quick Tips Section */}
            <div className="mt-10">
              <h3 className="text-xl font-bold text-accent mb-6">Quick Tips</h3>
              <div className="bg-white rounded-xl shadow-sm border border-gray-100 p-6">
                <ul className="space-y-3 text-gray-600">
                  <li className="flex items-start gap-3">
                    <span className="inline-flex items-center justify-center w-6 h-6 bg-primary-100 text-primary-600 rounded-full text-sm font-bold flex-shrink-0">1</span>
                    <span>Use the <strong>Portal Hub</strong> as your central navigation point to access all Thrive 365 Labs services.</span>
                  </li>
                  <li className="flex items-start gap-3">
                    <span className="inline-flex items-center justify-center w-6 h-6 bg-primary-100 text-primary-600 rounded-full text-sm font-bold flex-shrink-0">2</span>
                    <span>Your available portals depend on your role and permissions assigned by an administrator.</span>
                  </li>
                  <li className="flex items-start gap-3">
                    <span className="inline-flex items-center justify-center w-6 h-6 bg-primary-100 text-primary-600 rounded-full text-sm font-bold flex-shrink-0">3</span>
                    <span>Submit <strong>weekly inventory updates</strong> to keep stock levels accurate and receive timely alerts.</span>
                  </li>
                  <li className="flex items-start gap-3">
                    <span className="inline-flex items-center justify-center w-6 h-6 bg-primary-100 text-primary-600 rounded-full text-sm font-bold flex-shrink-0">4</span>
                    <span>Use the <strong>Live Chat</strong> feature for immediate assistance during business hours.</span>
                  </li>
                  <li className="flex items-start gap-3">
                    <span className="inline-flex items-center justify-center w-6 h-6 bg-primary-100 text-primary-600 rounded-full text-sm font-bold flex-shrink-0">5</span>
                    <span>Check the <strong>Link Directory</strong> for a complete reference of all portal URLs.</span>
                  </li>
                </ul>
              </div>
            </div>

            {/* Need Help Section */}
            <div className="mt-10 bg-gradient-to-r from-primary-500 to-primary-700 rounded-2xl p-8 text-white">
              <h3 className="text-2xl font-bold mb-3">Need Additional Help?</h3>
              <p className="text-white/80 mb-6">Can't find what you're looking for? Our support team is here to help.</p>
              <div className="flex flex-wrap gap-4">
                <a href="mailto:support@thrive365labs.com" className="bg-white text-primary-600 px-6 py-3 rounded-lg font-semibold hover:bg-gray-100 transition">
                  Email Support
                </a>
                <a href="/login" className="bg-white/20 text-white px-6 py-3 rounded-lg font-semibold hover:bg-white/30 transition">
                  Back to Portal Hub
                </a>
              </div>
            </div>
          </main>

          {/* Footer */}
          <footer className="mt-12 py-6 border-t border-gray-200 bg-white/50">
            <div className="max-w-6xl mx-auto px-4 text-center text-sm text-gray-500">
              &copy; 2026 Thrive 365 Labs. All rights reserved.
            </div>
          </footer>
        </div>
      );
    };

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
